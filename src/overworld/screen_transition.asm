
SCREEN_TRANSITION:
	BEGIN_C_FUNCTION_FAR
	STACK_RESERVE_VARS
	STACK_RESERVE_INT32
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	STACK_RESERVE_INT8
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_PARAM_INT16 ;int
	STACK_RESERVE_PARAM_INT16 ;int
	END_STACK_VARS
	TXY
	STY @LOCAL06
	STA @LOCAL05
	MOVE_INT_CONSTANT SCREEN_TRANSITION_CONFIG_TABLE, @VIRTUAL06
	LDA @LOCAL05
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(screen_transition_config)
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	STA @LOCAL04
	LDA @VIRTUAL06+2
	STA @LOCAL04+2
	MOVE_INT @VIRTUAL06, @VIRTUAL0A
	LDA [@VIRTUAL0A] ;screen_transition_config::duration
	AND #$00FF
	STA @VIRTUAL02
	CMP #>-1
	BNE @NOT_MAX_DURATION
	LDA #900
	STA @VIRTUAL02
@NOT_MAX_DURATION:
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::direction
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	ASL
	ASL
	TAX
	LDY #screen_transition_config::unknown5
	LDA [@VIRTUAL06],Y
	JSL UNKNOWN_C42631
	LDY @LOCAL06
	CPY #1
	BNEL @UNKNOWN10
	JSL UNKNOWN_C0943C
	LDA #2
	JSL UNKNOWN_C0DD2C
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::animation_id
	LDA [@VIRTUAL06],Y
	STA @LOCAL03
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQ @UNKNOWN2
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::animation_flags
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	TAX
	INX
	INX
	LDA @LOCAL03
	AND #$00FF
	JSL UNKNOWN_C4A67E
@UNKNOWN2:
	PROMOTENEARPTR PALETTES, @VIRTUAL06
	REP #PROC_FLAGS::ACCUM8
	MOVE_INT @VIRTUAL06, @LOCAL01
	LDA #^__BSS_START__
	STA @LOCAL01+2
.IF .DEFINED(JPN)
	MOVE_INT @LOCAL01, @VIRTUAL0A
	MOVE_INT @VIRTUAL0A, @LOCAL00
.ELSE
	MOVE_INT @LOCAL01, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
.ENDIF
	MOVE_INT @LOCAL04, @VIRTUAL06
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::fade_style
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	JSL UNKNOWN_C4954C
	LDX #.LOWORD(-1)
	LDA @VIRTUAL02
	JSL UNKNOWN_C496E7
	LDA #0
	STA @LOCAL02
	BRA @UNKNOWN5
@UNKNOWN3:
	LDA PALETTE_UPLOAD_MODE
	AND #$00FF
	BEQ @UNKNOWN4
	JSL WAIT_UNTIL_NEXT_FRAME
@UNKNOWN4:
	JSL UPDATE_MAP_PALETTE_ANIMATION
	JSL OAM_CLEAR
	JSL UNKNOWN_C4268A
	JSL UNKNOWN_C426C7
	JSL RUN_ACTIONSCRIPT_FRAME
	JSL UPDATE_SCREEN
	JSL UNKNOWN_C4A7B0
	JSL WAIT_UNTIL_NEXT_FRAME
	LDA @LOCAL02
	INC
	STA @LOCAL02
@UNKNOWN5:
	CMP @VIRTUAL02
	BCC @UNKNOWN3
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::fade_style
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #>-1
	STA @VIRTUAL02
	LDA #50
	CLC
	SBC @VIRTUAL02
	BRANCHLTEQS @UNKNOWN8
	JSL UNKNOWN_C08726
	BRA @UNKNOWN9
@UNKNOWN8:
	SEP #PROC_FLAGS::ACCUM8
	LDA #>-1
	STA @LOCAL00
	LDX #BPP4PALETTE_SIZE * 16
	REP #PROC_FLAGS::ACCUM8
	LDA #.LOWORD(PALETTES)
	JSL MEMSET16
	LDA #24
	JSL UNKNOWN_C0856B
	JSL WAIT_UNTIL_NEXT_FRAME
	LDA #1
	STA WIPE_PALETTES_ON_MAP_LOAD
@UNKNOWN9:
	JSL UNKNOWN_C09451
	JMP @UNKNOWN22
@UNKNOWN10:
	LDX #0
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::fade_style
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	STA @VIRTUAL02
	LDA #50
	CLC
	SBC @VIRTUAL02
	BRANCHLTEQS @UNKNOWN13
	LDX #1
@UNKNOWN13:
	TXY
	STY @LOCAL05
	BEQ @UNKNOWN14
	LDX #1
	TXA
	JSL FADE_IN
	BRA @UNKNOWN15
@UNKNOWN14:
	LDX #.LOWORD(-1)
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::secondary_duration
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	JSL UNKNOWN_C496E7
@UNKNOWN15:
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::secondary_animation_id
	LDA [@VIRTUAL06],Y
	STA @LOCAL03
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQ @UNKNOWN16
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::secondary_animation_flags
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	TAX
	LDA @LOCAL03
	AND #$00FF
	JSL UNKNOWN_C4A67E
@UNKNOWN16:
	LDA #0
	STA @LOCAL02
	BRA @UNKNOWN21
@UNKNOWN17:
	LDY @LOCAL05
	BNE @UNKNOWN19
	LDA PALETTE_UPLOAD_MODE
	AND #$00FF
	BEQ @UNKNOWN18
	JSL WAIT_UNTIL_NEXT_FRAME
@UNKNOWN18:
	JSL UPDATE_MAP_PALETTE_ANIMATION
@UNKNOWN19:
	JSL OAM_CLEAR
	JSL RUN_ACTIONSCRIPT_FRAME
	JSL UNKNOWN_C4A7B0
	JSL UPDATE_SCREEN
	JSL WAIT_UNTIL_NEXT_FRAME
	LDA @LOCAL02
	CMP #1
	BNE @UNKNOWN20
	JSL UNKNOWN_C0943C
@UNKNOWN20:
	LDA @LOCAL02
	INC
	STA @LOCAL02
@UNKNOWN21:
	SEP #PROC_FLAGS::ACCUM8
	LDY #screen_transition_config::secondary_duration
	LDA [@VIRTUAL06],Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	STA @VIRTUAL02
	LDA @LOCAL02
	CMP @VIRTUAL02
	BCC @UNKNOWN17
	LDY @LOCAL05
	BNE @UNKNOWN22
	JSL UNKNOWN_C49740
@UNKNOWN22:
	LDA GIYGAS_PHASE
	CMP #GIYGAS_PHASES::START_PRAYING
	BCS @UNKNOWN23
	JSL UNKNOWN_C2EAAA
@UNKNOWN23:
	JSL UNKNOWN_C09451
	STZ LADDER_STAIRS_TILE_Y
	STZ LADDER_STAIRS_TILE_X
	END_C_FUNCTION
