
OPEN_MENU_BUTTON:
	BEGIN_C_FUNCTION_FAR
	STACK_RESERVE_VARS
	STACK_RESERVE_INT32
	STACK_RESERVE_INT32
	STACK_RESERVE_INT8
	STACK_RESERVE_INT16
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	END_STACK_VARS
	JSL UNKNOWN_C0943C
	LDA #SFX::CURSOR1
	JSL PLAY_SOUND
	CREATE_WINDOW_NEAR #WINDOW::UNKNOWN00
	LDA #1
	STA @VIRTUAL02
	JMP @UNKNOWN7
@UNKNOWN1:
	LDA @VIRTUAL02
	CMP #3
	BNE @UNKNOWN2
	JSR UNKNOWN_C1C373
	CMP #0
	BEQL @UNKNOWN6
@UNKNOWN2:
	LDA @VIRTUAL02
	CMP #1
	BEQ @UNKNOWN3
	LDA @VIRTUAL02
	CMP #5
	BEQ @UNKNOWN3
	LDA @VIRTUAL02
	CMP #2
	BNE @UNKNOWN4
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	CMP #1
	BNE @UNKNOWN4
	LDX #1
	LDA GAME_STATE + game_state::party_members
	AND #$00FF
	JSL GET_CHARACTER_ITEM
	CMP #0
	BNE @UNKNOWN4
@UNKNOWN3:
	LDX #1
	BRA @UNKNOWN5
@UNKNOWN4:
	LDX #27
@UNKNOWN5:
	LDA @VIRTUAL02
	DEC
	STA @LOCAL07
	LOADPTR CMD_WINDOW_TEXT, @VIRTUAL06
	LDA @LOCAL07
	OPTIMIZED_MULT @VIRTUAL04, 5
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	STA @LOCAL00
	LDA @VIRTUAL06+2
	STA @LOCAL00+2
	MOVE_INT_CONSTANT NULL, @LOCAL01
	TXA
	SEP #PROC_FLAGS::ACCUM8
	STA @LOCAL02
	REP #PROC_FLAGS::ACCUM8
	LDA @LOCAL07
	LSR
	TAY
	STY @LOCAL06
	LDY #2
	LDA @VIRTUAL02
	JSL MODULUS16
	OPTIMIZED_MULT @VIRTUAL04, 5
	STA @VIRTUAL04
	LDA #5
	SEC
	SBC @VIRTUAL04
	TAX
	LDA @VIRTUAL02
	LDY @LOCAL06
	JSR UNKNOWN_C11596
@UNKNOWN6:
	INC @VIRTUAL02
@UNKNOWN7:
	LDA @VIRTUAL02
	CMP #7
	BCCL @UNKNOWN1
	JSR PRINT_MENU_ITEMS
@MAIN_PAUSE_MENU:
	LDA #0
	JSR SET_WINDOW_FOCUS
	JSR PRINT_MENU_ITEMS
	LDA #1
	JSR SELECTION_MENU
	STORE_INT1632 @VIRTUAL06
	LDA @VIRTUAL06
	CMP #MENU_OPTIONS::TALK_TO
	BEQ @TALK_TO
	CMP #MENU_OPTIONS::GOODS
	BEQ @GOODS
	CMP #MENU_OPTIONS::PSI
	BEQL @PSI
	CMP #MENU_OPTIONS::EQUIP
	BEQL @EQUIP
	CMP #MENU_OPTIONS::CHECK
	BEQL @CHECK
	CMP #MENU_OPTIONS::STATUS
	BEQL @STATUS
	JMP @UNKNOWN75
@TALK_TO:
	JSL TALK_TO
	MOVE_INT_CONSTANT NULL, @VIRTUAL0A
	CMP32 @VIRTUAL06, @VIRTUAL0A
	BNE @T012
	LOADPTR MSG_SYS_HANASU_NG, @VIRTUAL06
@T012:
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	JMP @UNKNOWN75
@GOODS:
	JSR UNKNOWN_C1134B
@UNKNOWN9:
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	CMP #1
	BNE @GOODS_MANY_PARTY_MEMBERS
	LDY #.LOWORD(GAME_STATE) + game_state::party_members
	STY @LOCAL05
	LDX #1
	LDA __BSS_START__,Y
	AND #$00FF
	JSL GET_CHARACTER_ITEM
	CMP #0
	BEQL @MAIN_PAUSE_MENU
	LDX #2
	LDY @LOCAL05
	LDA __BSS_START__,Y
	AND #$00FF
	JSR INVENTORY_GET_ITEM_NAME
	LDY @LOCAL05
	SEP #PROC_FLAGS::ACCUM8
	LDA __BSS_START__,Y
	STORE_INT832 @VIRTUAL06
	REP #PROC_FLAGS::ACCUM8
	MOVE_INT @VIRTUAL06, @LOCAL04
	LDA #0
	JSR UNKNOWN_C43573
	BRA @UNKNOWN12
@GOODS_MANY_PARTY_MEMBERS:
	LDA #0
	JSR UNKNOWN_C193E7
	LOADPTR UNKNOWN_C1339E, @LOCAL00
	MOVE_INT_CONSTANT NULL, @LOCAL01
	LDX #1
	LDA #0
	JSR CHAR_SELECT_PROMPT
	STORE_INT1632 @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL04
@UNKNOWN12:
	MOVE_INT_CONSTANT NULL, @VIRTUAL0A
	CMP32 @VIRTUAL06, @VIRTUAL0A
@UNKNOWN13:
	BNE @UNKNOWN14
	LDA #WINDOW::INVENTORY
	JSR CLOSE_WINDOW
	JSR UNKNOWN_C19437
	JMP @MAIN_PAUSE_MENU
@UNKNOWN14:
	LDX #1
	LDA @VIRTUAL06
	JSL GET_CHARACTER_ITEM
	CMP #0
	BEQL @UNKNOWN9
@UNKNOWN15:
	LDA #1
	JSR UNKNOWN_C193E7
	LDA #2
	JSR SET_WINDOW_FOCUS
	LDA #1
	JSR SELECTION_MENU
	STA @VIRTUAL02
	JSR UNKNOWN_C19437
	LDA @VIRTUAL02
	BNE @GOODS_ITEM_SELECTED
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	CMP #1
	BNEL @UNKNOWN9
	LDX #1
	LDA GAME_STATE + game_state::party_members
	AND #$00FF
	JSL GET_CHARACTER_ITEM
	CMP #0
	BEQ @UNKNOWN17
	LDA #SFX::MENU_OPEN_CLOSE
	JSL PLAY_SOUND
	JSR UNKNOWN_C3E6F8
@UNKNOWN17:
	LDA #WINDOW::INVENTORY
	JSR CLOSE_WINDOW
	JMP @MAIN_PAUSE_MENU
@GOODS_ITEM_SELECTED:
	CREATE_WINDOW_NEAR #WINDOW::INVENTORY_MENU
	MOVE_INT @LOCAL04, @VIRTUAL06
	LDA @VIRTUAL06
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	TAX
	LDA PARTY_CHARACTERS+char_struct::afflictions,X
	AND #$00FF
	TAX
	BEQ @GOODS_ITEM_SELECTED_ALIVE
	STX @VIRTUAL04
	LDA #4
	CLC
	SBC @VIRTUAL04
	BRANCHLTEQS @GOODS_ITEM_SELECTED_ALIVE
	LDX #1
	BRA @UNKNOWN22
@GOODS_ITEM_SELECTED_ALIVE:
	LDX #0
@UNKNOWN22:
	TXY
	STY @LOCAL03
	TYX
	LDA #0
	JSR UNKNOWN_C438A5
	BRA @UNKNOWN24
@UNKNOWN23:
	TYX
	INX
	STX @LOCAL05
	LOADPTR ITEM_USE_MENU_STRINGS, @VIRTUAL0A
	TYA
	OPTIMIZED_MULT @VIRTUAL04, 5
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	STA @LOCAL00
	LDA @VIRTUAL0A+2
	STA @LOCAL00+2
	MOVE_INT_CONSTANT NULL, @LOCAL01
	TXA
	JSR UNKNOWN_C115F4
	LDX @LOCAL05
	TXY
	STY @LOCAL03
@UNKNOWN24:
	LDY @LOCAL03
	CPY #4
	BCC @UNKNOWN23
	LDY #0
	TYX
	LDA #1
	JSR UNKNOWN_C451FA
@UNKNOWN25:
	LDA #3
	JSR SET_WINDOW_FOCUS
	JSR PRINT_MENU_ITEMS
	LDA #1
	JSR SELECTION_MENU
	STORE_INT1632 @VIRTUAL0A
	LDA @VIRTUAL0A
	BEQ @UNKNOWN30
	CMP #1
	BEQ @GOODS_ITEM_USE
	CMP #4
	BEQ @GOODS_ITEM_HELP
	CMP #2
	BEQL @UNKNOWN34
	CMP #3
	BEQL @UNKNOWN48
	JMP @UNKNOWN75
@UNKNOWN30:
	JSR CLOSE_FOCUS_WINDOW
	LDA #2
	JSR SET_WINDOW_FOCUS
	JSR PRINT_MENU_ITEMS
	JMP @UNKNOWN15
@GOODS_ITEM_USE:
	LDY #0
	LDX @VIRTUAL02
	MOVE_INT @LOCAL04, @VIRTUAL06
	LDA @VIRTUAL06
	JSR OVERWORLD_USE_ITEM
	CMP #0
	BEQ @UNKNOWN25
	JMP @UNKNOWN75
@GOODS_ITEM_HELP:
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	LDX @VIRTUAL02
	MOVE_INT @LOCAL04, @VIRTUAL06
	LDA @VIRTUAL06
	JSL GET_CHARACTER_ITEM
	STA @LOCAL07
	LOADPTR ITEM_CONFIGURATION_TABLE, @VIRTUAL06
	LDA @LOCAL07
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(item)
	CLC
	ADC #item::help_text
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	DEREFERENCE_PTR_TO @VIRTUAL06, @VIRTUAL0A
	MOVE_INT @VIRTUAL0A, @LOCAL00
	JSL DISPLAY_TEXT
	LDA #WINDOW::TEXT_STANDARD
	JSR CLOSE_WINDOW
	LDA #WINDOW::INVENTORY_MENU
	JSR CLOSE_WINDOW
	LDA #WINDOW::INVENTORY
	JSR SET_WINDOW_FOCUS
	JSR PRINT_MENU_ITEMS
	JMP @UNKNOWN15
@UNKNOWN34:
	LDA #3
	JSR UNKNOWN_C193E7
	LOADPTR UNKNOWN_C133A7, @LOCAL00
	MOVE_INT_CONSTANT NULL, @LOCAL01
	LDX #1
	LDA #2
	JSR CHAR_SELECT_PROMPT
	STA @VIRTUAL04
	STA @LOCAL05
	JSR UNKNOWN_C19437
	LDA #WINDOW::UNKNOWN2C
	JSR CLOSE_WINDOW
	LDA @VIRTUAL04
	BEQL @UNKNOWN25
	MOVE_INT @LOCAL04, @VIRTUAL06
	MOVE_INT1632 @VIRTUAL04, @VIRTUAL0A
	CMP32 @VIRTUAL0A, @VIRTUAL06
	BEQ @UNKNOWN37
	LDX @VIRTUAL02
	LDA @VIRTUAL06
	JSL GET_CHARACTER_ITEM
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(item)
	.A16
	CLC
	ADC #item::flags
	TAX
	LDA f:ITEM_CONFIGURATION_TABLE,X
	AND #$00FF
	AND #ITEM_FLAGS::CANNOT_GIVE
	BEQ @UNKNOWN37
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSR SET_WORKING_MEMORY
	MOVE_INT1632 @VIRTUAL02, @VIRTUAL0A
	MOVE_INT @VIRTUAL0A, @LOCAL00
	JSR SET_ARGUMENT_MEMORY
	DISPLAY_TEXT_PTR MSG_SYS_GOODS_NOCARRY
	LDA #1
	JSR CLOSE_WINDOW
	JMP @UNKNOWN25
@UNKNOWN37:
@UNKNOWN43:
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSR SET_WORKING_MEMORY
	MOVE_INT1632 @VIRTUAL02, @VIRTUAL0A
	MOVE_INT @VIRTUAL0A, @LOCAL00
	JSR SET_ARGUMENT_MEMORY
	DISPLAY_TEXT_PTR MSG_SYS_CARRY
	LDA @LOCAL05
	STA @VIRTUAL04
	STORE_INT1632 @VIRTUAL0A
	MOVE_INT @LOCAL04, @VIRTUAL06
	CMP32 @VIRTUAL0A, @VIRTUAL06
	BNE @UNKNOWN45
	LDY @VIRTUAL02
	LDA @VIRTUAL06
	TAX
	LDA @VIRTUAL04
	JSL UNKNOWN_C22A3A
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_SELF
	BRA @UNKNOWN47
@UNKNOWN45:
	LDA @VIRTUAL04
	JSL FIND_INVENTORY_SPACE2
	CMP #0
	BEQ @UNKNOWN46
	LDY @VIRTUAL02
	LDA @VIRTUAL06
	TAX
	LDA @VIRTUAL04
	JSL UNKNOWN_C22A3A
	MOVE_INT @VIRTUAL0A, @LOCAL00
	JSR SET_WORKING_MEMORY
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_OTHER
	BRA @UNKNOWN47
@UNKNOWN46:
	MOVE_INT @VIRTUAL0A, @LOCAL00
	JSR SET_WORKING_MEMORY
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_OTHER_NG
@UNKNOWN47:
	LDA #WINDOW::TEXT_STANDARD
	JSR CLOSE_WINDOW
	LDA #WINDOW::INVENTORY_MENU
	JSR CLOSE_WINDOW
	LDA #WINDOW::INVENTORY
	JSR CLOSE_WINDOW
	JMP @MAIN_PAUSE_MENU
@UNKNOWN48:
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	MOVE_INT @LOCAL04, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSR SET_WORKING_MEMORY
	MOVE_INT1632 @VIRTUAL02, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSR SET_ARGUMENT_MEMORY
	DISPLAY_TEXT_PTR MSG_SYS_GOODS_DROP
	LDA #WINDOW::TEXT_STANDARD
	JSR CLOSE_WINDOW
	LDA #WINDOW::INVENTORY_MENU
	JSR CLOSE_WINDOW
	LDA #WINDOW::INVENTORY
	JSR CLOSE_WINDOW
	JMP @MAIN_PAUSE_MENU
@PSI:
@UNKNOWN63:
	JSR UNKNOWN_C1134B
	JSR UNKNOWN_C1C373
	STORE_INT1632 @VIRTUAL06
	MOVE_INT_CONSTANT NULL, @VIRTUAL0A
	CMP32 @VIRTUAL06, @VIRTUAL0A
	BEQ @UNKNOWN66
	LDA @VIRTUAL06
	DEC
	JSR UNKNOWN_C43573
@UNKNOWN66:
	JSR UNKNOWN_C1B5B6
	CMP #0
	BNE @UNKNOWN75
@UNKNOWN67:
	JSR UNKNOWN_C1C3B6
	CMP #1
	BNEL @MAIN_PAUSE_MENU
	LDA #SFX::MENU_OPEN_CLOSE
	JSL PLAY_SOUND
	JSR UNKNOWN_C3E6F8
	JMP @MAIN_PAUSE_MENU
@EQUIP:
	JSR UNKNOWN_C1134B
	JSR UNKNOWN_C1AA5D
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	CMP #1
	BNEL @MAIN_PAUSE_MENU
	LDA #SFX::MENU_OPEN_CLOSE
	JSL PLAY_SOUND
	JSR UNKNOWN_C3E6F8
	JMP @MAIN_PAUSE_MENU
@CHECK:
	JSL CHECK
	MOVE_INT_CONSTANT NULL, @VIRTUAL0A
	CMP32 @VIRTUAL06, @VIRTUAL0A
	BNE @UNKNOWN73
	LOADPTR MSG_SYS_NOPROBLEM, @VIRTUAL06
@UNKNOWN73:
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	BRA @UNKNOWN75
@STATUS:
	JSR UNKNOWN_C1134B
	JSR UNKNOWN_C1BB71
	JMP @MAIN_PAUSE_MENU
@UNKNOWN75:
	JSR CLEAR_INSTANT_PRINTING
	JSR HIDE_HPPP_WINDOWS
	JSR UNKNOWN_C1008E
@UNKNOWN76:
	JSL WINDOW_TICK
	.A16
	LDA ENTITY_FADE_ENTITY
	CMP #.LOWORD(-1)
	BNE @UNKNOWN76
	JSL UNKNOWN_C09451
	END_C_FUNCTION

OPEN_MENU_BUTTON_CHECKTALK:
	BEGIN_C_FUNCTION_FAR
	STACK_RESERVE_VARS
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	END_STACK_VARS
	JSL UNKNOWN_C0943C
	LDA #SFX::CURSOR1
	JSL PLAY_SOUND
	JSL TALK_TO
	MOVE_INT_CONSTANT NULL, @VIRTUAL0A
	CMP32 @VIRTUAL06, @VIRTUAL0A
	BNE @UNKNOWN79
	JSL CHECK
	CMP32 @VIRTUAL06, @VIRTUAL0A
	BNE @UNKNOWN79
	LOADPTR MSG_SYS_NOPROBLEM, @VIRTUAL06
@UNKNOWN79:
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	JSR CLEAR_INSTANT_PRINTING
	JSR HIDE_HPPP_WINDOWS
	JSR UNKNOWN_C1008E
@UNKNOWN80:
	JSL WINDOW_TICK
	LDA ENTITY_FADE_ENTITY
	CMP #.LOWORD(-1)
	BNE @UNKNOWN80
	JSL UNKNOWN_C09451
	END_C_FUNCTION
