
MAP_INPUT_TO_DIRECTION:
	BEGIN_C_FUNCTION_FAR
	STACK_RESERVE_VARS
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_PARAM_INT16 ;int style
	STACK_RESERVE_RETURN_INT16 ;int
	END_STACK_VARS
	STA @LOCAL01
	LDX #.LOWORD(-1)
	STX @LOCAL00
	LDA PENDING_INTERACTIONS
	BEQ @UNKNOWN0
	TXA
	JMP @RETURN
@UNKNOWN0:
	LDA @LOCAL01
	ASL
	TAX
	LDA f:ALLOWED_INPUT_DIRECTIONS,X
	STA @LOCAL01
	LDA PAD_STATE
	AND #PAD::UP | PAD::DOWN | PAD::LEFT | PAD::RIGHT
	CMP #PAD::UP
	BEQ @UP_PRESSED
	CMP #PAD::UP | PAD::RIGHT
	BEQ @UP_RIGHT_PRESSED
	CMP #PAD::RIGHT
	BEQ @RIGHT_PRESSED
	CMP #PAD::DOWN | PAD::RIGHT
	BEQ @DOWN_RIGHT_PRESSED
	CMP #PAD::DOWN
	BEQ @DOWN_PRESSED
	CMP #PAD::DOWN | PAD::LEFT
	BEQ @DOWN_LEFT_PRESSED
	CMP #PAD::LEFT
	BEQ @LEFT_PRESSED
	CMP #PAD::UP | PAD::LEFT
	BEQ @UP_LEFT_PRESSED
	BRA @RETURN_DEFAULT
@UP_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::UP
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::UP
	STX @LOCAL00
	BRA @RETURN_DEFAULT
@UP_RIGHT_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::UP_RIGHT
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::UP_RIGHT
	STX @LOCAL00
	BRA @RETURN_DEFAULT
@RIGHT_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::RIGHT
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::RIGHT
	STX @LOCAL00
	BRA @RETURN_DEFAULT
@DOWN_RIGHT_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::DOWN_RIGHT
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::DOWN_RIGHT
	STX @LOCAL00
	BRA @RETURN_DEFAULT
@DOWN_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::DOWN
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::DOWN
	STX @LOCAL00
	BRA @RETURN_DEFAULT
@DOWN_LEFT_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::DOWN_LEFT
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::DOWN_LEFT
	STX @LOCAL00
	BRA @RETURN_DEFAULT
@LEFT_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::LEFT
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::LEFT
	STX @LOCAL00
	BRA @RETURN_DEFAULT
@UP_LEFT_PRESSED:
	LDA @LOCAL01
	AND #DIRECTION_MASK::UP_LEFT
	BEQ @RETURN_DEFAULT
	LDX #DIRECTION::UP_LEFT
	STX @LOCAL00
@RETURN_DEFAULT:
	LDX @LOCAL00
	TXA
@RETURN:
	END_C_FUNCTION
