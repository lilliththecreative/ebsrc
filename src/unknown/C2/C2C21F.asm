
UNKNOWN_C2C21F:
	BEGIN_C_FUNCTION
	STACK_RESERVE_VARS
.IF .DEFINED(JPN)
	STACK_RESERVE_INT32 "LOCALM2"
	STACK_RESERVE_INT16 "LOCALM22"
.ENDIF
	STACK_RESERVE_INT16 "LOCAL00"
	STACK_RESERVE_INT16 "LOCAL01"
	STACK_RESERVE_INT16 "LOCAL02"
	STACK_RESERVE_INT16 "LOCAL03"
	STACK_RESERVE_PARAM_INT16 ;int battleGroup
	STACK_RESERVE_PARAM_INT16 ;int
	END_STACK_VARS
	STX @LOCAL03
	STA @LOCAL02
	STZ @LOCAL01
	LDA BATTLE_MODE_FLAG
	BEQ @UNKNOWN0
	LDA @LOCAL02
	CMP #ENEMY_GROUP::BOSS_GIYGAS_PHASE_FINAL
	BNE @UNKNOWN1
@UNKNOWN0:
	LDA #1
	STA @LOCAL01
@UNKNOWN1:
	LDA @LOCAL01
	BNE @UNKNOWN4
	LDY #30
	LDX #1
	LDA #6
	JSL UNKNOWN_C2E8C4
	BRA @UNKNOWN3
@UNKNOWN2:
	JSL WINDOW_TICK
@UNKNOWN3:
	JSL UNKNOWN_C2E9C8
	CMP #0
	BNE @UNKNOWN2
@UNKNOWN4:
	LDA @LOCAL02
	STA CURRENT_BATTLE_GROUP
	LOADPTR BTL_ENTRY_BG_TABLE, @VIRTUAL06
	LDA CURRENT_BATTLE_GROUP
	ASL
	ASL
	STA @LOCAL00
	MOVE_INTX @VIRTUAL06, @VIRTUAL0A
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	LDA [@VIRTUAL0A]
.IF .DEFINED(JPN)
	STA @LOCALM22
	LDA @LOCAL00
.ELSE
	STA @VIRTUAL04
	LDA @LOCAL00
.ENDIF
	INC
	INC
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	LDA [@VIRTUAL06]
.IF .DEFINED(JPN)
	STA @VIRTUAL04
.ELSE
	STA @VIRTUAL02
.ENDIF
	LDA CURRENT_BATTLE_GROUP
	ASL
	ASL
	ASL
	CLC
	ADC #battle_entry_ptr_entry::letterbox_style
	TAX
	LDA f:BTL_ENTRY_PTR_TABLE,X
	AND #$00FF
.IF .DEFINED(JPN)
	STA @VIRTUAL02
	JSL UNKNOWN_C08726
	JSL LOAD_ENEMY_BATTLE_SPRITES
	JSL LOAD_WINDOW_GFX
	COPY_TO_VRAM1 BUFFER, $6000, $3800, 0
	LDY @VIRTUAL02
	LDX @VIRTUAL04
	LDA @LOCALM22
	.A16
.ELSE
	TAX
	STX @LOCAL00
	JSL UNKNOWN_C08726
	JSL LOAD_ENEMY_BATTLE_SPRITES
	JSL LOAD_WINDOW_GFX
	LDA #1
	JSL UNKNOWN_C44963
	LDX @LOCAL00
	TXY
	LDX @VIRTUAL02
	LDA @VIRTUAL04
.ENDIF
	JSL LOAD_BATTLE_BG
	JSL UNKNOWN_C2EEE7
	LDA #24
	JSL UNKNOWN_C0856B
	JSL UNKNOWN_C2F8F9
	LDA #1
	STA BATTLE_MODE_FLAG
	LDA @LOCAL03
	BEQ @UNKNOWN5
	LDA @LOCAL03
	JSL CHANGE_MUSIC
@UNKNOWN5:
	JSL UNKNOWN_C08744
	LDA @LOCAL01
	BEQ @UNKNOWN6
	LDX #4
	LDA #1
	JSL FADE_IN
	JSR UNKNOWN_C269DE
	BRA @RETURN
@UNKNOWN6:
	LDX #1
	LDA #15
	JSL FADE_IN
	LDA @LOCAL02
	CMP #ENEMY_GROUP::BOSS_GIYGAS_PHASE_FINAL
	BEQ @RETURN
	LDY #5
	LDX #0
	LDA #6
	JSL UNKNOWN_C2E8C4
	BRA @UNKNOWN8
@UNKNOWN7:
	JSL WINDOW_TICK
@UNKNOWN8:
	JSL UNKNOWN_C2E9C8
	CMP #0
	BNE @UNKNOWN7
@RETURN:
	END_C_FUNCTION
