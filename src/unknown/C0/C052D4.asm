
UNKNOWN_C052D4:
	BEGIN_C_FUNCTION_FAR
	STACK_RESERVE_VARS
	STACK_RESERVE_INT32
	STACK_RESERVE_INT32
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_PARAM_INT16
	END_STACK_VARS
	STA @LOCAL0A
	LDA #$00FF
	STA @LOCAL09
	STA GAME_STATE + game_state::unknown88
	LDA GAME_STATE+game_state::leader_x_coord
	STA @LOCAL08
	LDA GAME_STATE+game_state::leader_y_coord
	STA @LOCAL07
	LDA GAME_STATE+game_state::trodden_tile_type
	STA @VIRTUAL04
	STA @LOCAL06
	LDA GAME_STATE+game_state::walking_style
	STA @LOCAL05
	LDA @LOCAL0A
	INC
	INC
	INC
	INC
	AND #$0007
	STA @VIRTUAL02
	LDY #.LOWORD(GAME_STATE) + game_state::unknown80
	STY @LOCAL04
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	LDX @VIRTUAL04
	LDA @VIRTUAL02
	JSR ADJUST_POSITION_HORIZONTAL
	LDY @LOCAL04
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL0A
	SEC
	SUB_INT_ASSIGN @VIRTUAL06, @VIRTUAL0A
	MOVE_INT @VIRTUAL06, @LOCAL01
	LDY #.LOWORD(GAME_STATE) + game_state::unknown84
	STY @LOCAL04
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	LDX @VIRTUAL04
	LDA @VIRTUAL02
	JSR ADJUST_POSITION_VERTICAL
	LDY @LOCAL04
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL0A
	SEC
	SUB_INT_ASSIGN @VIRTUAL06, @VIRTUAL0A
	MOVE_INT @VIRTUAL06, @LOCAL02
	LDX #256
	BRA @UNKNOWN1
@UNKNOWN0:
	TXA
	DEC
	STA @LOCAL04
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(player_position_buffer_entry)
	CLC
	ADC #.LOWORD(PLAYER_POSITION_BUFFER)
	TAX
	LDA @LOCAL08
	STA a:player_position_buffer_entry::x_coord,X
	LDA @LOCAL07
	STA a:player_position_buffer_entry::y_coord,X
	LDA @LOCAL06
	STA @VIRTUAL04
	STA a:player_position_buffer_entry::tile_flags,X
	LDA @LOCAL05
	STA a:player_position_buffer_entry::walking_style,X
	LDA @LOCAL0A
	STA a:player_position_buffer_entry::direction,X
	STZ a:player_position_buffer_entry::unknown10,X
	LDA @LOCAL08
	CLC
	ADC @LOCAL01 + fixed_point::integer
	STA @LOCAL08
	LDA @LOCAL07
	CLC
	ADC @LOCAL02 + fixed_point::integer
	STA @LOCAL07
	LDA @LOCAL04
	TAX
@UNKNOWN1:
	BNE @UNKNOWN0
	LDA @LOCAL09
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(player_position_buffer_entry)
	CLC
	ADC #.LOWORD(PLAYER_POSITION_BUFFER)
	TAX
	STX @LOCAL04
	LDA #0
	STA @LOCAL03
.IF .DEFINED(JPN)
	JMP @UNKNOWN3
.ELSE
	BRA @UNKNOWN3
.ENDIF
@UNKNOWN2:
.IF .DEFINED(JPN)
	CLC
	ADC #.LOWORD(GAME_STATE)
	TAX
	LDA a:game_state::player_controlled_party_members,X
.ELSE
	TAX
	LDA GAME_STATE+game_state::player_controlled_party_members,X
.ENDIF
	AND #$00FF
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	CLC
	ADC #.LOWORD(PARTY_CHARACTERS)
	TAY
	LDA @LOCAL09
	STA __BSS_START__+char_struct::position_index,Y
	LDA #.LOWORD(-1)
	STA __BSS_START__+char_struct::unknown63 + 2,Y
	STA __BSS_START__+char_struct::unknown53 + 2,Y
	LDA @LOCAL03
	ASL
	STA @VIRTUAL02
	CLC
.IF .DEFINED(JPN)
	ADC #.LOWORD(GAME_STATE)
	CLC
	ADC #game_state::unknownA2
.ELSE
	ADC #.LOWORD(GAME_STATE) + game_state::unknownA2
.ENDIF
	TAY
	LDA __BSS_START__,Y
	ASL
	PHA
	LDX @LOCAL04
	LDA a:player_position_buffer_entry::x_coord,X
	PLX
	STA ENTITY_ABS_X_TABLE,X
	LDA __BSS_START__,Y
	ASL
	PHA
	LDX @LOCAL04
	LDA a:player_position_buffer_entry::y_coord,X
	PLX
	STA ENTITY_ABS_Y_TABLE,X
	LDX @LOCAL04
	LDA a:player_position_buffer_entry::direction,X
	LDX @VIRTUAL02
	STA ENTITY_DIRECTIONS,X
	LDX @LOCAL04
	LDA a:player_position_buffer_entry::tile_flags,X
	LDX @VIRTUAL02
	STA ENTITY_SURFACE_FLAGS,X
	LDA @LOCAL09
	SEC
	SBC #16
	STA @LOCAL09
	LDX @LOCAL04
	TXA
	SEC
	SBC #192
	TAX
	STX @LOCAL04
	LDA @LOCAL03
	INC
	STA @LOCAL03
@UNKNOWN3:
	LDA GAME_STATE+game_state::party_count
	AND #$00FF
	STA @VIRTUAL02
	LDA @LOCAL03
	CMP @VIRTUAL02
	BCCL @UNKNOWN2
	END_C_FUNCTION
