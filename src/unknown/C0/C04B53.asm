
UNKNOWN_C04B53:
	BEGIN_C_FUNCTION
	STACK_RESERVE_VARS
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	END_STACK_VARS
	LDX GAME_STATE+game_state::walking_style
	STX @LOCAL02
	CPX #WALKING_STYLE::STAIRS
	BEQ @UNKNOWN0
	LDA GAME_STATE+game_state::leader_direction
	STA @LOCAL01
	BRA @UNKNOWN1
@UNKNOWN0:
	LDA AUTO_MOVEMENT_DIRECTION
	STA @LOCAL01
@UNKNOWN1:
	LDA #.LOWORD(GAME_STATE) + game_state::unknownB0
	STA @VIRTUAL02
	LDX @VIRTUAL02
	LDA __BSS_START__,X
	AND #$00FF
	CMP #1
	BEQ @UNKNOWN4
	CMP #2
	BEQL @UNKNOWN6
	CMP #3
	BEQL @UNKNOWN7
	JMP @UNKNOWN8
@UNKNOWN4:
	LDY #.LOWORD(GAME_STATE) + game_state::unknown80
	STY @LOCAL00
	LDA @LOCAL01
	OPTIMIZED_MULT @VIRTUAL04, 4
	STA @VIRTUAL04
	LDX @LOCAL02
	TXA
	OPTIMIZED_MULT @VIRTUAL04, 32
	CLC
	ADC @VIRTUAL04
	STA @LOCAL01
	CLC
	ADC #.LOWORD(HORIZONTAL_MOVEMENT_SPEEDS)
	TAY
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL0A
	LDY @LOCAL00
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL06
	CLC
	ADD_INT_ASSIGN @VIRTUAL06, @VIRTUAL0A
	MOVE_INT_YPTRDEST @VIRTUAL06, __BSS_START__
	LDY #.LOWORD(GAME_STATE) + game_state::unknown84
	STY @LOCAL02
	LDA @LOCAL01
	CLC
	ADC #.LOWORD(VERTICAL_MOVEMENT_SPEEDS)
	TAY
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL0A
	LDY @LOCAL02
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL06
	CLC
	ADD_INT_ASSIGN @VIRTUAL06, @VIRTUAL0A
	MOVE_INT_YPTRDEST @VIRTUAL06, __BSS_START__
	LDX #.LOWORD(GAME_STATE) + game_state::unknownB2
	LDA __BSS_START__,X
	DEC
	STA __BSS_START__,X
	BNE @UNKNOWN5
	LDA #0
	LDX @VIRTUAL02
	STA __BSS_START__,X
	LDA GAME_STATE + game_state::unknownB4
	STA GAME_STATE+game_state::walking_style
@UNKNOWN5:
	LDA #1
	STA GAME_STATE + game_state::unknown90
	BRA @UNKNOWN8
@UNKNOWN6:
	JSR UNKNOWN_C0476D
	BRA @UNKNOWN8
@UNKNOWN7:
	JSR UNKNOWN_C04AAD
@UNKNOWN8:
	END_C_FUNCTION
