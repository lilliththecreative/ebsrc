
UNKNOWN_C08496: ;$C08496
	SEP #PROC_FLAGS::ACCUM8
@WAIT_UNTIL_READY:
	LDA HVBJOY
	LSR
	BCS @WAIT_UNTIL_READY
	JSR READ_JOYPAD
	JSR UNKNOWN_C08456
	REP #PROC_FLAGS::ACCUM8 | PROC_FLAGS::INDEX8
	LDX #$0002
@UNKNOWN1:
	LDA <PAD_RAW,X
	AND #$FFF0
	STA <PAD_TEMP
	LDA <PAD_STATE,X
	EOR #$FFFF
	AND <PAD_TEMP + 0
	STA <PAD_PRESS,X
	LDA <PAD_TEMP + 0
	CMP <PAD_STATE,X
	STA <PAD_STATE,X
	BEQ @UNKNOWN2
	LDA <PAD_PRESS,X
	STA <PAD_HELD,X
	LDA #$0014
	STA <PAD_TIMER,X
	BRA @UNKNOWN4
@UNKNOWN2:
	LDY <PAD_TIMER,X
	BEQ @UNKNOWN3
	DEC <PAD_TIMER,X
	STZ <PAD_HELD,X
	BRA @UNKNOWN4
@UNKNOWN3:
	STA <PAD_HELD,X
	LDA #$0003
	STA <PAD_TIMER,X
@UNKNOWN4:
	DEX
	DEX
	BPL @UNKNOWN1
	LDA f:DEBUG
	BNE @UNKNOWN5
	LDA <PAD_STATE + 2
	ORA <PAD_STATE + 0
	STA <PAD_STATE
	LDA <PAD_HELD + 2
	ORA <PAD_HELD + 0
	STA <PAD_HELD
	LDA <PAD_PRESS + 2
	ORA <PAD_PRESS + 0
	STA <PAD_PRESS
@UNKNOWN5:
	LDA <PAD_PRESS + 0
	BEQ @UNKNOWN6
	INC PLAYER_HAS_DONE_SOMETHING_THIS_FRAME
@UNKNOWN6:
	RTS
