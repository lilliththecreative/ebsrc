
UNKNOWN_C43573:
.IF .DEFINED(JPN)
	BEGIN_C_FUNCTION
.ELSE
	BEGIN_C_FUNCTION_FAR
.ENDIf
	STACK_RESERVE_VARS
	STACK_RESERVE_INT16
	STACK_RESERVE_PARAM_INT16
	END_STACK_VARS
	STA @LOCAL00
	LDA BATTLE_MENU_CURRENT_CHARACTER_ID
	CMP #.LOWORD(-1)
	BEQ @UNKNOWN0
.IF .DEFINED(PROTOTYPE19950327)
	JSL UNKNOWN_C3E6F8 ; should be possible with JSR, but ca65 seems to be forcing absolute addressing for some reason...
.ELSE
	JSR UNKNOWN_C3E6F8
.ENDIF
@UNKNOWN0:
	LDA @LOCAL00
	STA BATTLE_MENU_CURRENT_CHARACTER_ID
.IF .DEFINED(USA) && (!.DEFINED(PROTOTYPE19950327))
	JSL WAIT_UNTIL_NEXT_FRAME
	LDA @LOCAL00
.ENDIF
	OPTIMIZED_MULT @VIRTUAL04, 7
	STA @VIRTUAL02
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	OPTIMIZED_MULT @VIRTUAL04, 7
	PHA
	ASL
	PLA
	ROR
	STA @VIRTUAL04
	LDA #16
	SEC
	SBC @VIRTUAL04
	CLC
	ADC @VIRTUAL02
	ASL
	CLC
.IF .DEFINED(JPN)
	ADC #.LOWORD(BG2_BUFFER)
	CLC
	ADC #((ACTIVE_HPPP_WINDOW_Y_OFFSET + HPPP_WINDOW_HEIGHT) * 32) * 2
.ELSE
	ADC #.LOWORD(BG2_BUFFER) + ((ACTIVE_HPPP_WINDOW_Y_OFFSET + HPPP_WINDOW_HEIGHT) * 32) * 2
.ENDIF
	TAX
	LDA #7
	STA @LOCAL00
	BRA @UNKNOWN2
@UNKNOWN1:
	LDA #0
	STA __BSS_START__,X
	INX
	INX
	LDA @LOCAL00
	DEC
	STA @LOCAL00
@UNKNOWN2:
	BNE @UNKNOWN1
	SEP #PROC_FLAGS::ACCUM8
	LDA #1
	STA REDRAW_ALL_WINDOWS
	REP #PROC_FLAGS::ACCUM8
	END_C_FUNCTION
