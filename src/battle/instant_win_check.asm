
INSTANT_WIN_CHECK:
	BEGIN_C_FUNCTION_FAR
	STACK_RESERVE_VARS
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_RETURN_INT16
	END_STACK_VARS
	LDA BATTLE_INITIATIVE
	CMP #INITIATIVE::ENEMIES_FIRST
	BNE @UNKNOWN0
	LDA #0
	JMP @UNKNOWN37
@UNKNOWN0:
	STZ @LOCAL09
	STZ @LOCAL08
	LDA #$FFFF
	STA @VIRTUAL02
	STA @LOCAL07
	LDA @VIRTUAL02
	STA @VIRTUAL04
	LDY #0
	STY @LOCAL06
	JMP @UNKNOWN7
@UNKNOWN1:
.IF .DEFINED(JPN)
	TYA
	CLC
	ADC #.LOWORD(GAME_STATE)
	TAX
	LDA a:game_state::party_members,X
.ELSE
	LDA GAME_STATE + game_state::party_members,Y
.ENDIF
	AND #$00FF
	TAX
	STX @LOCAL05
	CPX #1
	BCCL @UNKNOWN6
	CPX #4
	BGTL @UNKNOWN6
	TXA
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	TAX
	LDA PARTY_CHARACTERS+char_struct::speed,X
	AND #$00FF
	CMP @VIRTUAL04
	BCS @UNKNOWN4
	STA @VIRTUAL04
@UNKNOWN4:
	LDX @LOCAL05
	TXA
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	TAX
	LDA PARTY_CHARACTERS+char_struct::offense,X
	AND #$00FF
	CMP @VIRTUAL02
	BCS @UNKNOWN5
	STA @VIRTUAL02
	STA @LOCAL07
@UNKNOWN5:
	LDX @LOCAL05
	TXA
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	STA @LOCAL04
	CLC
	ADC #.LOWORD(PARTY_CHARACTERS) + char_struct::afflictions
	TAX
	LDA a:STATUS_GROUP::PERSISTENT_EASYHEAL,X
	AND #$00FF
	STA @LOCAL03
	CMP #STATUS_0::UNCONSCIOUS
	BEQ @UNKNOWN6
	LDA @LOCAL03
	CMP #STATUS_0::DIAMONDIZED
	BEQ @UNKNOWN6
	LDA @LOCAL03
	CMP #STATUS_0::PARALYZED
	BEQ @UNKNOWN6
	LDA @LOCAL03
	CMP #STATUS_0::NAUSEOUS
	BEQ @UNKNOWN6
	LDA @LOCAL03
	CMP #STATUS_0::POISONED
	BEQ @UNKNOWN6
	LDA @LOCAL03
	CMP #STATUS_0::SUNSTROKE
	BEQ @UNKNOWN6
	LDA @LOCAL03
	CMP #STATUS_0::COLD
	BEQ @UNKNOWN6
	LDA a:STATUS_GROUP::PERSISTENT_HARDHEAL,X
	AND #$00FF
	TAX
	CPX #STATUS_1::MUSHROOMIZED
	BEQ @UNKNOWN6
	CPX #STATUS_1::POSSESSED
	BEQ @UNKNOWN6
	LDA @LOCAL08
	ASL
	PHA
	LDA @LOCAL04
	TAX
	LDA PARTY_CHARACTERS+char_struct::offense,X
	AND #$00FF
	PLX
	STA INSTANT_WIN_SORTED_OFFENSE,X
	INC @LOCAL08
@UNKNOWN6:
	LDY @LOCAL06
	INY
	STY @LOCAL06
@UNKNOWN7:
	CPY #6
	BCCL @UNKNOWN1
	LDA ENEMIES_IN_BATTLE
	CMP @LOCAL08
	BLTEQ @UNKNOWN9
	LDA #0
	JMP @UNKNOWN37
@UNKNOWN9:
	LDA BATTLE_INITIATIVE
	BNEL @UNKNOWN18
	LDA #0
	STA @LOCAL05
	BRA @UNKNOWN13
@UNKNOWN11:
	ASL
	TAX
	LDA ENEMIES_IN_BATTLE_IDS,X
	LDY #.SIZEOF(enemy_data)
	JSL MULT168
	CLC
	ADC #enemy_data::speed
	TAX
	LDA f:ENEMY_CONFIGURATION_TABLE,X
	AND #$00FF
	TAX
	CPX @LOCAL09
	BLTEQ @UNKNOWN12
	STX @LOCAL09
@UNKNOWN12:
	LDA @LOCAL05
	INC
	STA @LOCAL05
@UNKNOWN13:
	CMP ENEMIES_IN_BATTLE
	BCC @UNKNOWN11
	LDA @VIRTUAL04
	CMP @LOCAL09
	BCS @UNKNOWN14
	LDA #0
	JMP @UNKNOWN37
@UNKNOWN14:
	LDA #0
	STA @LOCAL03
	BRA @UNKNOWN17
@UNKNOWN15:
	LOADPTR ENEMY_CONFIGURATION_TABLE, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL02
	LDA @LOCAL03
	ASL
	TAX
	LDA ENEMIES_IN_BATTLE_IDS,X
	LDY #.SIZEOF(enemy_data)
	JSL MULT168
	TAX
	CLC
	ADC #enemy_data::defense
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	LDA [@VIRTUAL06]
	STA @VIRTUAL02
	TXA
	CLC
	ADC #enemy_data::hp
	MOVE_INTX @LOCAL02, @VIRTUAL06
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	LDA [@VIRTUAL06]
	CLC
	ADC @VIRTUAL02
	STA @VIRTUAL04
	LDA @LOCAL07
	STA @VIRTUAL02
	ASL
	CMP @VIRTUAL04
	BCS @UNKNOWN16
	LDA #0
	JMP @UNKNOWN37
@UNKNOWN16:
	LDA @LOCAL03
	INC
	STA @LOCAL03
@UNKNOWN17:
	CMP ENEMIES_IN_BATTLE
	BCC @UNKNOWN15
	LDA #1
	JMP @UNKNOWN37
@UNKNOWN18:
	LDA #0
	STA @LOCAL03
	BRA @UNKNOWN20
@UNKNOWN19:
	ASL
	TAY
	STY @LOCAL05
	LOADPTR ENEMY_CONFIGURATION_TABLE, @VIRTUAL06
	TYA
	CLC
	ADC #.LOWORD(ENEMIES_IN_BATTLE_IDS)
	TAX
	LDA __BSS_START__,X
	LDY #.SIZEOF(enemy_data)
	JSL MULT168
	CLC
	ADC #enemy_data::hp
	MOVE_INTY @VIRTUAL06, @VIRTUAL0A
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	LDA [@VIRTUAL0A]
	LDY @LOCAL05
	STA INSTANT_WIN_SORTED_HP,Y
	LDA __BSS_START__,X
	LDY #.SIZEOF(enemy_data)
	JSL MULT168
	CLC
	ADC #enemy_data::defense
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	LDA [@VIRTUAL06]
	LDY @LOCAL05
	STA INSTANT_WIN_SORTED_DEFENSE,Y
	LDA @LOCAL03
	INC
	STA @LOCAL03
@UNKNOWN20:
	CMP ENEMIES_IN_BATTLE
	BCC @UNKNOWN19
@UNKNOWN21:
	LDY #1
	LDX #0
	STX @LOCAL09
	BRA @UNKNOWN26
@UNKNOWN22:
	TXA
	INC
	STA @LOCAL06
	BRA @UNKNOWN25
@UNKNOWN23:
	LDX @LOCAL09
	TXA
	ASL
	CLC
	ADC #.LOWORD(INSTANT_WIN_SORTED_OFFENSE)
	STA @LOCAL07
	LDA (@LOCAL07)
	STA @LOCAL01
	LDA @LOCAL06
	ASL
	CLC
	ADC #.LOWORD(INSTANT_WIN_SORTED_OFFENSE)
	STA @VIRTUAL04
	LDX @VIRTUAL04
	LDA __BSS_START__,X
	STA @VIRTUAL02
	CMP @LOCAL01
	BLTEQ @UNKNOWN24
	LDY #0
	LDA @VIRTUAL02
	STA (@LOCAL07)
	LDA @LOCAL01
	LDX @VIRTUAL04
	STA __BSS_START__,X
@UNKNOWN24:
	LDA @LOCAL06
	INC
	STA @LOCAL06
@UNKNOWN25:
	CMP @LOCAL08
	BCC @UNKNOWN23
	LDX @LOCAL09
	INX
	STX @LOCAL09
@UNKNOWN26:
	LDA @LOCAL08
	DEC
	STA @VIRTUAL02
	TXA
	CMP @VIRTUAL02
	BCC @UNKNOWN22
	CPY #0
	BEQ @UNKNOWN21
@UNKNOWN27:
	LDA #1
	STA @LOCAL07
	LDA #0
	STA @VIRTUAL02
	BRA @UNKNOWN32
@UNKNOWN28:
	LDY @VIRTUAL02
	INY
	BRA @UNKNOWN31
@UNKNOWN29:
	LDA @VIRTUAL02
	ASL
	TAX
	CLC
	ADC #.LOWORD(INSTANT_WIN_SORTED_HP)
	STA @LOCAL05
	LDA (@LOCAL05)
	STA @LOCAL00
	TYA
	ASL
	STA @LOCAL09
	CLC
	ADC #.LOWORD(INSTANT_WIN_SORTED_HP)
	STA @LOCAL03
	LDA (@LOCAL03)
	STA @VIRTUAL04
	CMP @LOCAL00
	BLTEQ @UNKNOWN30
	STZ @LOCAL07
	LDA @VIRTUAL04
	STA (@LOCAL05)
	LDA @LOCAL00
	STA (@LOCAL03)
	TXA
	CLC
	ADC #.LOWORD(INSTANT_WIN_SORTED_DEFENSE)
	STA @LOCAL05
	LDA (@LOCAL05)
	STA @VIRTUAL04
	LDA @LOCAL09
	CLC
	ADC #.LOWORD(INSTANT_WIN_SORTED_DEFENSE)
	TAX
	LDA __BSS_START__,X
	STA (@LOCAL05)
	LDA @VIRTUAL04
	STA __BSS_START__,X
@UNKNOWN30:
	INY
@UNKNOWN31:
	CPY ENEMIES_IN_BATTLE
	BCC @UNKNOWN29
	INC @VIRTUAL02
@UNKNOWN32:
	LDA ENEMIES_IN_BATTLE
	DEC
	STA @VIRTUAL04
	LDA @VIRTUAL02
	CMP @VIRTUAL04
	BCC @UNKNOWN28
	LDA @LOCAL07
	BEQ @UNKNOWN27
	LDX #0
	STX @LOCAL09
	TXA
	STA @LOCAL06
	BRA @UNKNOWN36
@UNKNOWN33:
	ASL
	TAX
	LDA INSTANT_WIN_SORTED_OFFENSE,X
	ASL
	STA @VIRTUAL04
	LDX @LOCAL09
	TXA
	ASL
	STA @LOCAL05
	CLC
	ADC #.LOWORD(INSTANT_WIN_SORTED_HP)
	STA @VIRTUAL02
	STA @LOCAL03
	LDX @VIRTUAL02
	LDA __BSS_START__,X
	TAY
	STY @LOCAL04
	LDY #.LOWORD(INSTANT_WIN_SORTED_DEFENSE)
	LDA (@LOCAL05),Y
	STA @LOCAL05
	LDY @LOCAL04
	TYA
	CLC
	ADC @LOCAL05
	STA @VIRTUAL02
	LDA @VIRTUAL04
	CMP @VIRTUAL02
	BCS @UNKNOWN34
	LDA @VIRTUAL04
	SEC
	SBC @LOCAL05
	STA @VIRTUAL02
	TYA
	SEC
	SBC @VIRTUAL02
	LDX @LOCAL03
	STX @VIRTUAL02
	STA __BSS_START__,X
	BRA @UNKNOWN35
@UNKNOWN34:
	LDX @LOCAL09
	INX
	STX @LOCAL09
	CPX ENEMIES_IN_BATTLE
	BCC @UNKNOWN35
	LDA #1
	BRA @UNKNOWN37
@UNKNOWN35:
	LDA @LOCAL06
	INC
	STA @LOCAL06
@UNKNOWN36:
	CMP @LOCAL08
	BCC @UNKNOWN33
	LDA #0
@UNKNOWN37:
	END_C_FUNCTION
