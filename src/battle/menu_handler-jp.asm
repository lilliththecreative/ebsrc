
BATTLE_SELECTION_MENU: ;$C2311B
	REP #PROC_FLAGS::ACCUM8 | PROC_FLAGS::INDEX8 | PROC_FLAGS::CARRY
	RESERVE_STACK_SPACE 40
	STX $26
	STA $24
	LDA #$0000
	JSL UNKNOWN_C2FEF9
	LDA $24
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	CLC
<<<<<<< HEAD
	ADC #.LOWORD(PARTY_CHARACTERS)
	STA @VIRTUAL04
	STA @LOCAL07
	LDX @VIRTUAL04
=======
	ADC #.LOWORD(CHAR_STRUCT)
	STA $04
	STA $22
	LDX $04
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	LDA a:char_struct::afflictions,X
	AND #$00FF
	CMP #STATUS_0::PARALYZED
	BEQ @UNKNOWN0
	LDX $04
	LDA a:char_struct::afflictions+2,X
	AND #$00FF
	CMP #STATUS_2::IMMOBILIZED
	BNE @UNKNOWN1
@UNKNOWN0:
	LDA #$0002
	STA $20
	BRA @UNKNOWN4
@UNKNOWN1:
	LDX $04
	LDA a:char_struct::equipment+EQUIPMENT_SLOT::WEAPON,X
	AND #$00FF
	BEQ @UNKNOWN2
	DEC
	STA $02
	LDA $04
	CLC
	ADC $02
	TAX
	LDA __BSS_START__+34,X
	AND #$00FF
@UNKNOWN2:
	CMP #$0000
	BEQ @UNKNOWN3
	OPTIMIZED_MULT $04, .SIZEOF(item)
	CLC
	ADC #item::type
	TAX
	LDA f:ITEM_CONFIGURATION_TABLE,X
	AND #$00FF
	AND #$0003
	CMP #$0001
	BNE @UNKNOWN3
	LDA #$0001
	STA $20
	BRA @UNKNOWN4
@UNKNOWN3:
	STZ $20
@UNKNOWN4:
	LDA GAME_STATE+game_state::auto_fight_enable
	AND #$00FF
	BEQL @UNKNOWN43
	LDA $22
	STA $04
	LDX $04
	LDA a:char_struct::afflictions+4,X
	AND #$00FF
	BNEL @UNKNOWN38
	LDX $04
	LDA a:char_struct::afflictions+3,X
	AND #$00FF
	CMP #STATUS_3::STRANGE
	BEQL @UNKNOWN38
	LDX $04
	LDA a:char_struct::afflictions+1,X
	AND #$00FF
	CMP #STATUS_1::MUSHROOMIZED
	BEQL @UNKNOWN38
	LDA $24
	CMP #$0001
	BEQ @UNKNOWN9
	LDA $24
	CMP #$0004
	BNEL @UNKNOWN38
@UNKNOWN9:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #1
	STA BATTLE_MENU_SELECTION + battle_menu_selection::targetting
	LDA #26
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #35
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #26
	LDA @LOCAL08
=======
	LDA #$0001
	STA UNKNOWN_7EA97D + unknown_A97D::unknown4
	LDA #$001A
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0023
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$001A
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQ @UNKNOWN15
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_LIFEUP_OMEGA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN15
	LDA #$0000
	JSL COUNT_CHARS
	CMP #$0002
	BCC @UNKNOWN15
	LDA #$0000
	STA $1E
	BRA @UNKNOWN14
@UNKNOWN11:
	CLC
	ADC #.LOWORD(GAME_STATE)
	TAX
	LDA a:game_state::party_members,X
	AND #$00FF
	TAX
	CPX #$0001
	BCC @UNKNOWN13
	CPX #$0004
	BGT @UNKNOWN13
	TXA
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	TAX
	LDA PARTY_CHARACTERS+char_struct::max_hp,X
	LSR
	LSR
	CMP PARTY_CHARACTERS+char_struct::current_hp_target,X
	BLTEQ @UNKNOWN15
@UNKNOWN13:
	LDA $1E
	INC
	STA $1E
@UNKNOWN14:
	CMP #$0006
	BCC @UNKNOWN11
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #4
	STA BATTLE_MENU_SELECTION + battle_menu_selection::targetting
	JMP @UNKNOWN21
@UNKNOWN15:
	SEP #PROC_FLAGS::ACCUM8
	LDA #25
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #34
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #25
	LDA @LOCAL08
=======
	LDA #$0004
	STA UNKNOWN_7EA97D + unknown_A97D::unknown4
	JMP @UNKNOWN21
@UNKNOWN15:
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0019
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0022
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$0019
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQ @UNKNOWN17
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_LIFEUP_GAMMA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN17
	JSL AUTOLIFEUP
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
@UNKNOWN17:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #24
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #33
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #24
	LDA @LOCAL08
=======
	LDA #$0018
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0021
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$0018
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQ @UNKNOWN19
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_LIFEUP_BETA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN19
	JSL AUTOLIFEUP
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNE @UNKNOWN21
@UNKNOWN19:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #23
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #32
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #23
	LDA @LOCAL08
=======
	LDA #$0017
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0020
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$0017
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQ @UNKNOWN22
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_LIFEUP_ALPHA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN22
	JSL AUTOLIFEUP
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQ @UNKNOWN22
@UNKNOWN21:
	REP #PROC_FLAGS::ACCUM8
	LDA $24
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION
	REP #PROC_FLAGS::ACCUM8
	LDA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	JMP @UNKNOWN113
@UNKNOWN22:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #30
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #39
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #30
	LDA @LOCAL08
=======
	LDA #$001E
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0027
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$001E
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQ @UNKNOWN24
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_HEALING_OMEGA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN24
	LDX #$0001
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNE @UNKNOWN21
@UNKNOWN24:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #29
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #38
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #29
	LDA @LOCAL08
=======
	LDA #$001D
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0026
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$001D
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQ @UNKNOWN28
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_HEALING_GAMMA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN28
	LDX #$0003
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDY #.LOWORD(BATTLE_MENU_SELECTION) + battle_menu_selection::selected_target
	STY @LOCAL04
=======
	LDY #.LOWORD(UNKNOWN_7EA97D) + unknown_A97D::unknown5
	STY $1C
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
	LDX #$0002
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	LDY $1C
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
	LDX #$0001
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	LDY $1C
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
@UNKNOWN28:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #28
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #37
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #28
	LDA @LOCAL08
=======
	LDA #$001C
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0025
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$001C
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQL @UNKNOWN34
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_HEALING_BETA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN34
	LDX #$0005
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDY #.LOWORD(BATTLE_MENU_SELECTION) + battle_menu_selection::selected_target
	STY @LOCAL09
=======
	LDY #.LOWORD(UNKNOWN_7EA97D) + unknown_A97D::unknown5
	STY $26
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
	LDX #$0004
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	LDY $26
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
	LDX #$0002
	TXA
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	LDY $26
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
	LDX #$0001
	LDA #$0003
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	LDY $26
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
@UNKNOWN34:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #27
	STA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
	LDA #36
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	LDX #27
	LDA @LOCAL08
=======
	LDA #$001B
	STA UNKNOWN_7EA97D + unknown_A97D::unknown1
	REP #PROC_FLAGS::ACCUM8
	LDA #$0024
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	LDX #$001B
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JSL CHECK_IF_PSI_KNOWN
	CMP #$0000
	BEQ @UNKNOWN38
	LDX $04
	LDA f:BATTLE_ACTION_TABLE + (.SIZEOF(battle_action) * BATTLE_ACTIONS::PSI_HEALING_ALPHA) + battle_action::pp_cost
	AND #$00FF
	CMP a:char_struct::current_pp_target,X
	BGT @UNKNOWN38
	LDX #$0007
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDY #.LOWORD(BATTLE_MENU_SELECTION) + battle_menu_selection::selected_target
	STY @LOCAL04
=======
	LDY #.LOWORD(UNKNOWN_7EA97D) + unknown_A97D::unknown5
	STY $1C
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
	LDX #$0006
	LDA #$0000
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	LDY $1C
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
	LDX #$0001
	LDA #$0002
	JSL AUTOHEALING
	SEP #PROC_FLAGS::ACCUM8
	LDY $1C
	STA __BSS_START__,Y
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BNEL @UNKNOWN21
@UNKNOWN38:
	LDA $20
	BEQ @UNKNOWN39
	CMP #$0001
	BEQ @UNKNOWN40
	CMP #$0002
	BEQ @UNKNOWN41
	BRA @UNKNOWN42
@UNKNOWN39:
	LDA #$0004
	STA $1A
	BRA @UNKNOWN42
@UNKNOWN40:
	LDA #$0005
	STA $1A
	BRA @UNKNOWN42
@UNKNOWN41:
	LDA #$0001
	JMP @UNKNOWN113
@UNKNOWN42:
	LDA $24
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION
	STZ BATTLE_MENU_SELECTION + battle_menu_selection::param1
	REP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA @LOCAL03
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	SEP #PROC_FLAGS::ACCUM8
	LDA #17
	STA BATTLE_MENU_SELECTION + battle_menu_selection::targetting
=======
	LDA $1A
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0011
	STA UNKNOWN_7EA97D + unknown_A97D::unknown4
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	REP #PROC_FLAGS::ACCUM8
	LDA NUM_BATTLERS_IN_FRONT_ROW
	CLC
	ADC NUM_BATTLERS_IN_BACK_ROW
	JSR RAND_LIMIT
	SEP #PROC_FLAGS::ACCUM8
	INC
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	LDA $1A
	JMP @UNKNOWN113
@UNKNOWN43:
	JSL UNKNOWN_EF0262
	LDA $24
	CMP #$0002
	BEQ @UNKNOWN44
	LDA $24
	CMP #$0004
	BNE @UNKNOWN45
@UNKNOWN44:
	LDA #$0001
	STA $1A
	BRA @UNKNOWN46
@UNKNOWN45:
	STZ $1A
@UNKNOWN46:
	LDA $26
	BNE @UNKNOWN47
	INC $1A
@UNKNOWN47:
	LOADPTR BATTLE_WINDOW_SIZES, $06
	LDA $1A
	CLC
	ADC $06
	STA $06
	LDA [$06]
	AND #$00FF
	JSL REDIRECT_CREATE_WINDOW
	LDA $24
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	CLC
<<<<<<< HEAD
	ADC #.LOWORD(PARTY_CHARACTERS)
	PROMOTENEARPTRA @VIRTUAL0A
=======
	ADC #.LOWORD(CHAR_STRUCT)
	PROMOTENEARPTRA $0A
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	REP #PROC_FLAGS::ACCUM8
	MOVE_INT $0A, $0E
	LDX #$0004
	LDA [$06]
	AND #$00FF
	JSL SET_WINDOW_TITLE
	LDA $20
	BEQ @UNKNOWN48
	CMP #$0001
	BEQ @UNKNOWN49
	CMP #$0002
	BEQ @UNKNOWN50
	BRA @UNKNOWN51
@UNKNOWN48:
	LOADPTR BATTLE_MENU_TEXT_BASH, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDY #$0000
	TYX
	LDA #$0001
	JSL SELECTION_MENU_ITEM_SETUP
	BRA @UNKNOWN51
@UNKNOWN49:
	LOADPTR BATTLE_MENU_TEXT_SHOOT, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDY #$0000
	TYX
	LDA #$0001
	JSL SELECTION_MENU_ITEM_SETUP
	BRA @UNKNOWN51
@UNKNOWN50:
	LOADPTR BATTLE_MENU_TEXT_DO_NOTHING, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDY #$0000
	TYX
	LDA #$0001
	JSL SELECTION_MENU_ITEM_SETUP
@UNKNOWN51:
	LDA $20
	CMP #$0002
	BEQ @UNKNOWN53
@UNKNOWN52:
	LOADPTR BATTLE_MENU_TEXT, $06
	MOVE_INT $06, $16
	MOVE_INT_CONSTANT NULL, $0A
	LDA #$0005
	CLC
	ADC $06
	STA $06
	STA $0E
	LDA $08
	STA $10
	MOVE_INT $0A, $12
	LDY #$0000
	LDX #$0005
	LDA #$0002
	JSL SELECTION_MENU_ITEM_SETUP
	LDA #$0014
	MOVE_INTX $16, $06
	CLC
	ADC $06
	STA $06
	STA $0E
	LDA $08
	STA $10
	MOVE_INT $0A, $12
	LDY #$0001
	LDX #$0005
	TXA
	JSL SELECTION_MENU_ITEM_SETUP
@UNKNOWN53:
	LDA $26
	BNEL @UNKNOWN59
	LDA $1A
	CMP #$0002
	BNE @UNKNOWN55
	LDX #$000F
	BRA @UNKNOWN56
@UNKNOWN55:
	LDX #$000A
@UNKNOWN56:
	STX $26
	LOADPTR BATTLE_MENU_TEXT, $06
	MOVE_INT $06, $16
	MOVE_INT_CONSTANT NULL, $0A
	LDA #$000A
	CLC
	ADC $06
	STA $06
	STA $0E
	LDA $08
	STA $10
	MOVE_INT $0A, $12
	LDY #$0000
	LDX $26
	LDA #$0003
	JSL SELECTION_MENU_ITEM_SETUP
	LDA #$0028
	MOVE_INTX $16, $06
	CLC
	ADC $06
	STA $06
	STA $0E
	LDA $08
	STA $10
	MOVE_INT $0A, $12
	LDY #$0001
	LDX $26
	LDA #$0006
	JSL SELECTION_MENU_ITEM_SETUP
@UNKNOWN59:
	LDA $24
	CMP #$0003
	BNE @UNKNOWN60
	LOADPTR BATTLE_MENU_TEXT_SPY, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDY #$0001
	LDX #$0000
	LDA #$0004
	JSL SELECTION_MENU_ITEM_SETUP
	BRA @UNKNOWN61
@UNKNOWN60:
	LDA $22
	STA $04
	LDX $04
	LDA a:char_struct::afflictions+4,X
	AND #$00FF
	BNE @UNKNOWN61
	LOADPTR BATTLE_MENU_TEXT_PSI, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDY #$0001
	LDX #$0000
	LDA #$0004
	JSL SELECTION_MENU_ITEM_SETUP
@UNKNOWN61:
	LDA $24
	CMP #$0002
	BNE @UNKNOWN62
	LOADPTR BATTLE_MENU_TEXT_PRAY, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDY #$0000
	LDX #$000A
	LDA #$0007
	JSL SELECTION_MENU_ITEM_SETUP
@UNKNOWN62:
	LDA $24
	CMP #$0004
	BNE @UNKNOWN63
	LOADPTR BATTLE_MENU_TEXT_MIRROR, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDY #$0000
	LDX #$000A
	LDA #$0007
	JSL SELECTION_MENU_ITEM_SETUP
@UNKNOWN63:
	LDX $1A
	LDA f:BATTLE_WINDOW_SIZES,X
	AND #$00FF
	JSL REDIRECT_SET_WINDOW_FOCUS
	JSL REDIRECT_PRINT_MENU_ITEMS
	LDA #$0001
	JSL REDIRECT_SELECTION_MENU
	CMP #$0000
	BNEL @UNKNOWN74
	LDA DEBUG
	BEQ @UNKNOWN67
	LDA PAD_STATE
	AND #PAD::SELECT_BUTTON | PAD::START_BUTTON
	CMP #PAD::SELECT_BUTTON | PAD::START_BUTTON
	BNE @UNKNOWN66
	JSL RESUME_MUSIC
	LDA #$FFFF
	JMP @UNKNOWN113
@UNKNOWN66:
	LDA PAD_STATE
	AND #PAD::R_BUTTON
	BEQ @UNKNOWN67
	JSL UNKNOWN_E14DE8
	BRA @UNKNOWN63
@UNKNOWN67:
	LDA BATTLE_MODE
	BNE @UNKNOWN73
	LDA PAD_STATE
	AND #PAD::L_BUTTON
	BEQ @UNKNOWN72
	JSL DEBUG_SET_CHAR_LEVEL
	LDY #$0000
	STY $26
	BRA @UNKNOWN71
@UNKNOWN68:
	TYA
	CLC
	ADC #.LOWORD(GAME_STATE)
	TAX
	LDA a:game_state::party_members,X
	AND #$00FF
	STA $22
	BEQ @UNKNOWN70
	CMP #$0004
	BGT @UNKNOWN70
	TYA
	LDY #.SIZEOF(battler)
	JSL MULT168
	CLC
	ADC #.LOWORD(BATTLERS_TABLE)
	TAX
	LDA $22
	JSL BATTLE_INIT_PLAYER_STATS
@UNKNOWN70:
	LDY $26
	INY
	STY $26
@UNKNOWN71:
	CPY #$0006
	BCC @UNKNOWN68
	JMP @UNKNOWN63
@UNKNOWN72:
	LDA PAD_STATE
	AND #PAD::SELECT_BUTTON
	BEQ @UNKNOWN73
	JSL DEBUG_Y_BUTTON_GOODS
	JMP @UNKNOWN63
@UNKNOWN73:
	JSL RESUME_MUSIC
	LDA #$0000
	JMP @UNKNOWN113
@UNKNOWN74:
	SEP #PROC_FLAGS::ACCUM8
	STZ BATTLE_ITEM_USED
	REP #PROC_FLAGS::ACCUM8
	CMP #$0001
	BEQ @UNKNOWN81
	CMP #$0002
	BEQL @UNKNOWN88
	CMP #$0003
	BEQL @UNKNOWN90
	CMP #$0004
	BEQL @UNKNOWN91
	CMP #$0005
	BEQL @UNKNOWN95
	CMP #$0006
	BEQL @UNKNOWN96
	CMP #$0007
	BEQL @UNKNOWN97
	JMP @UNKNOWN112
@UNKNOWN81:
	LDA $20
	BEQ @UNKNOWN82
	CMP #$0001
	BEQ @UNKNOWN83
	CMP #$0002
	BEQ @UNKNOWN84
	BRA @UNKNOWN85
@UNKNOWN82:
	LDA #BATTLE_ACTIONS::BASH
	STA $02
	STA $1C
	BRA @UNKNOWN85
@UNKNOWN83:
	LDA #BATTLE_ACTIONS::SHOOT
	STA $02
	STA $1C
	BRA @UNKNOWN85
@UNKNOWN84:
	LDA #BATTLE_ACTIONS::USE_NO_EFFECT
	STA $02
	STA $1C
@UNKNOWN85:
<<<<<<< HEAD
	LDA @LOCAL04
	STA @VIRTUAL02
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	SEP #PROC_FLAGS::ACCUM8
	LDA #17
	STA BATTLE_MENU_SELECTION + battle_menu_selection::targetting
=======
	LDA $1C
	STA $02
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0011
	STA UNKNOWN_7EA97D + unknown_A97D::unknown4
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	REP #PROC_FLAGS::ACCUM8
	LDA $20
	CMP #$0002
	BEQL @UNKNOWN112
	LDY $02
	LDX #$0001
	LDA #$0000
	JSL REDIRECT_C1242E
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQL @UNKNOWN63
	JMP @UNKNOWN112
@UNKNOWN88:
	LDA $24
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION
	REP #PROC_FLAGS::ACCUM8
	LDA #.LOWORD(BATTLE_MENU_SELECTION)
	JSL REDIRECT_C1CFC6
	TAX
	BEQL @UNKNOWN63
	LDA BATTLE_MENU_SELECTION + battle_menu_selection::param1
	AND #$00FF
	TAX
	LDA $24
	JSL GET_CHARACTER_ITEM
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_ITEM_USED
	REP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	STA @VIRTUAL02
	STA @LOCAL04
=======
	LDA UNKNOWN_7EA97D + unknown_A97D::unknown2
	STA $02
	STA $1C
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	JMP @UNKNOWN112
@UNKNOWN90:
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0001
	STA GAME_STATE+game_state::auto_fight_enable
	JSL UNKNOWN_C20266
	.A16
	LDA #BATTLE_ACTIONS::NO_EFFECT
	STA $02
	STA $1C
	JMP @UNKNOWN112
@UNKNOWN91:
	LDA $24
	CMP #$0003
	BNE @UNKNOWN93
	LDA #BATTLE_ACTIONS::SPY
<<<<<<< HEAD
	STA @VIRTUAL02
	STA @LOCAL04
	LDA @VIRTUAL02
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	SEP #PROC_FLAGS::ACCUM8
	LDA #17
	STA BATTLE_MENU_SELECTION + battle_menu_selection::targetting
	LDY @VIRTUAL02
	LDX #1
=======
	STA $02
	STA $1C
	LDA $02
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0011
	STA UNKNOWN_7EA97D + unknown_A97D::unknown4
	LDY $02
	LDX #$0001
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	REP #PROC_FLAGS::ACCUM8
	LDA #$0000
	JSL REDIRECT_C1242E
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQL @UNKNOWN63
	JMP @UNKNOWN112
@UNKNOWN93:
	LDA $24
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION
	REP #PROC_FLAGS::ACCUM8
	LDA #.LOWORD(BATTLE_MENU_SELECTION)
	JSL REDIRECT_BATTLE_PSI_MENU
	TAX
	BEQL @UNKNOWN63
	SEP #PROC_FLAGS::ACCUM8
	STZ BATTLE_ITEM_USED
	REP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	STA @VIRTUAL02
	STA @LOCAL04
	JMP @UNKNOWN112
@UNKNOWN95:
	LDA #BATTLE_ACTIONS::GUARD
	STA @VIRTUAL02
	STA @LOCAL04
	LDA @VIRTUAL02
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
=======
	LDA UNKNOWN_7EA97D + unknown_A97D::unknown2
	STA $02
	STA $1C
	JMP @UNKNOWN112
@UNKNOWN95:
	LDA #BATTLE_ACTIONS::GUARD
	STA $02
	STA $1C
	LDA $02
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	SEP #PROC_FLAGS::ACCUM8
	STZ BATTLE_MENU_SELECTION + battle_menu_selection::targetting
	JMP @UNKNOWN112
@UNKNOWN96:
	SEP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #1
	STA BATTLE_MENU_SELECTION + battle_menu_selection::targetting
=======
	LDA #$0001
	STA UNKNOWN_7EA97D + unknown_A97D::unknown4
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	REP #PROC_FLAGS::ACCUM8
	LDA $24
	SEP #PROC_FLAGS::ACCUM8
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_target
	REP #PROC_FLAGS::ACCUM8
	LDA #BATTLE_ACTIONS::RUN_AWAY
<<<<<<< HEAD
	STA @VIRTUAL02
	STA @LOCAL04
	LDA @VIRTUAL02
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	JMP @UNKNOWN112
@UNKNOWN97:
	LDX #.LOWORD(BATTLE_MENU_SELECTION) + battle_menu_selection::targetting
	STX @LOCAL09
=======
	STA $02
	STA $1C
	LDA $02
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	JMP @UNKNOWN112
@UNKNOWN97:
	LDX #.LOWORD(UNKNOWN_7EA97D) + unknown_A97D::unknown4
	STX $26
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0001
	STA __BSS_START__,X
	REP #PROC_FLAGS::ACCUM8
<<<<<<< HEAD
	LDA #.LOWORD(BATTLE_MENU_SELECTION) + battle_menu_selection::selected_target
	STA @VIRTUAL04
	LDA @LOCAL08
=======
	LDA #.LOWORD(UNKNOWN_7EA97D) + unknown_A97D::unknown5
	STA $04
	LDA $24
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	SEP #PROC_FLAGS::ACCUM8
	LDX $04
	STA __BSS_START__,X
	REP #PROC_FLAGS::ACCUM8
	LDA $24
	CMP #$0002
	BEQ @UNKNOWN99
	CMP #$0004
	BEQL @UNKNOWN111
	JMP @UNKNOWN112
@UNKNOWN99:
	LDA GIYGAS_PHASE
	CMP #GIYGAS_PHASES::START_PRAYING
	BEQ @UNKNOWN100
	CMP #GIYGAS_PHASES::PRAYER_1_USED
	BEQ @UNKNOWN101
	CMP #GIYGAS_PHASES::PRAYER_2_USED
	BEQ @UNKNOWN102
	CMP #GIYGAS_PHASES::PRAYER_3_USED
	BEQ @UNKNOWN103
	CMP #GIYGAS_PHASES::PRAYER_4_USED
	BEQ @UNKNOWN104
	CMP #GIYGAS_PHASES::PRAYER_5_USED
	BEQ @UNKNOWN105
	CMP #GIYGAS_PHASES::PRAYER_6_USED
	BEQ @UNKNOWN106
	CMP #GIYGAS_PHASES::PRAYER_7_USED
	BEQ @UNKNOWN107
	CMP #GIYGAS_PHASES::PRAYER_8_USED
	BEQ @UNKNOWN108
	BRA @UNKNOWN109
@UNKNOWN100:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_1
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN101:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_2
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN102:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_3
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN103:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_4
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN104:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_5
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN105:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_6
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN106:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_7
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN107:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_8
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN108:
	LDA #BATTLE_ACTIONS::FINAL_PRAYER_9
	STA $02
	STA $1C
	BRA @UNKNOWN110
@UNKNOWN109:
	LDA #BATTLE_ACTIONS::PRAY
	STA $02
	STA $1C
@UNKNOWN110:
<<<<<<< HEAD
	LDA @VIRTUAL02
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
	BRA @UNKNOWN112
@UNKNOWN111:
	LDA #BATTLE_ACTIONS::MIRROR
	STA @VIRTUAL02
	STA @LOCAL04
	LDA @VIRTUAL02
	STA BATTLE_MENU_SELECTION + battle_menu_selection::selected_action
=======
	LDA $02
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
	BRA @UNKNOWN112
@UNKNOWN111:
	LDA #BATTLE_ACTIONS::MIRROR
	STA $02
	STA $1C
	LDA $02
	STA UNKNOWN_7EA97D + unknown_A97D::unknown2
>>>>>>> parent of e89e3811 (switch to new stack macro, delete old one and replace some magic numbers)
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0011
	LDX $26
	STA __BSS_START__,X
	LDY $02
	LDX #$0001
	REP #PROC_FLAGS::ACCUM8
	LDA #$0000
	JSL REDIRECT_C1242E
	SEP #PROC_FLAGS::ACCUM8
	LDX $04
	STA __BSS_START__,X
	REP #PROC_FLAGS::ACCUM8
	AND #$00FF
	BEQL @UNKNOWN63
@UNKNOWN112:
	LDX $1A
	REP #PROC_FLAGS::ACCUM8
	LDA f:BATTLE_WINDOW_SIZES,X
	AND #$00FF
	JSL REDIRECT_SET_WINDOW_FOCUS
	JSL RESUME_MUSIC
	LDA $1C
	STA $02
@UNKNOWN113:
	PLD
	RTL
