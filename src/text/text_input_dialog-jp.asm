
TEXT_INPUT_DIALOG:
	BEGIN_C_FUNCTION
	STACK_RESERVE_VARS
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_RETURN_INT16
	END_STACK_VARS
	STY @LOCAL0D
	STX @LOCAL0C
	STA @LOCAL0B
	LDX @PARAM04
	STX @LOCAL0A
	LDY @PARAM03
	TYX
	STX @LOCAL09
	LDA #.LOWORD(-1)
	STA @LOCAL08
	LDA #0
	STA @VIRTUAL04
	STA @LOCAL07
@UNKNOWN1:
	JSR SET_INSTANT_PRINTING
	CREATE_WINDOW_NEAR #WINDOW::FILE_SELECT_NAMING_KEYBOARD
	LDA CURRENT_FOCUS_WINDOW
	ASL
	TAX
	LDA OPEN_WINDOW_TABLE,X
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(window_stats)
	CLC
	ADC #.LOWORD(WINDOW_STATS)
	STA @LOCAL06
	LDA @LOCAL0A
	CMP #.LOWORD(-1)
	BNE @UNKNOWN2
	LOADPTR NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS, @VIRTUAL0A
	LDX @LOCAL09
	TXA
	OPTIMIZED_MULT @VIRTUAL04, 4
	CLC
	ADC #4 * 3
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	DEREFERENCE_PTR_TO @VIRTUAL0A, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	BRA @UNKNOWN3
@UNKNOWN2:
	LOADPTR NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS, @VIRTUAL0A
	LDX @LOCAL09
	TXA
	OPTIMIZED_MULT @VIRTUAL04, 4
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	DEREFERENCE_PTR_TO @VIRTUAL0A, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
@UNKNOWN3:
	LDX #3
	LDA #25
	JSR UNKNOWN_C438A5
	LDA #$001A
	JSR PRINT_LETTER
	LDX #4
	LDA #25
	JSR UNKNOWN_C438A5
	LDA #$001B
	JSR PRINT_LETTER
@UNKNOWN3_4:
	JSR CLEAR_INSTANT_PRINTING
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSR UNKNOWN_C438A5
	LDA #1
	JSR UNKNOWN_C10FEA
	LDA #33
	JSR UNKNOWN_C10D60
	LDA #0
	JSR UNKNOWN_C10FEA
	JSL WINDOW_TICK
	LDA #1
	STA @LOCAL05
@UNKNOWN3_5:
	LDA @LOCAL05
	EOR #$0001
	STA @LOCAL05
	LDY #window_stats::text_y
	LDA (@LOCAL06),Y
	ASL
	LDY #window_stats::window_y
	CLC
	ADC (@LOCAL06),Y
	OPTIMIZED_MULT @VIRTUAL04, 32
	STA @VIRTUAL02
	LDY #window_stats::window_x
	LDA (@LOCAL06),Y
	LDY #window_stats::text_x
	CLC
	ADC (@LOCAL06),Y
	CLC
	ADC @VIRTUAL02
	CLC
	ADC #VRAM::TEXT_LAYER_TILEMAP + TILEMAP_COORDS 0, 1
	STA @LOCAL09
	LDA @LOCAL05
	ASL
	STA @VIRTUAL02
	LOADPTR UNKNOWN_C3E406, @VIRTUAL06
	LDA @VIRTUAL02
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	STA @LOCAL00
	LDA @VIRTUAL06+2
	STA @LOCAL00+2
	LDY @LOCAL09
	LDX #2
	SEP #PROC_FLAGS::ACCUM8
	LDA #0
	JSL PREPARE_VRAM_COPY
	.A16
	LOADPTR UNKNOWN_C3E40A, @VIRTUAL06
	LDA @VIRTUAL02
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	STA @LOCAL00
	LDA @VIRTUAL06+2
	STA @LOCAL00+2
	LDA @LOCAL09
	CLC
	ADC #32
	TAY
	LDX #2
	SEP #PROC_FLAGS::ACCUM8
	LDA #0
	JSL PREPARE_VRAM_COPY
	.A16
	LDX #0
	STX @LOCAL04
	JMP @UNKNOWN18_2
@UNKNOWN2_2:
	JSL UNKNOWN_C1004E
	LDA PAD_PRESS
	AND #PAD::UP
	BEQ @UNKNOWN2_
	LDA #0
	STA @LOCAL00
	LDA #$007C
	STA @LOCAL00+2
	LDA @LOCAL07
	STA @LOCAL01
	LDY #window_stats::height
	LDA (@LOCAL06),Y
	LSR
	STA @LOCAL02
	LDY #.LOWORD(-1)
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN2_:
	LDA PAD_PRESS
	AND #PAD::LEFT
	BEQ @UNKNOWN3_
	LDA #.LOWORD(-1)
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDY #window_stats::width
	LDA (@LOCAL06),Y
	STA @LOCAL01
	LDA @VIRTUAL04
	STA @LOCAL02
	LDY #0
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN3_:
	LDA PAD_PRESS
	AND #PAD::DOWN
	BEQ @UNKNOWN3_2
	LDA #0
	STA @LOCAL00
	LDA #$007C
	STA @LOCAL00+2
	LDA @LOCAL07
	STA @LOCAL01
	LDA #.LOWORD(-1)
	STA @LOCAL02
	LDY #1
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN3_2:
	LDA PAD_PRESS
	AND #PAD::RIGHT
	BEQ @UNKNOWN3_3
	LDA #1
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDA #.LOWORD(-1)
	STA @LOCAL01
	LDA @VIRTUAL04
	STA @LOCAL02
	LDY #0
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN3_3:
	LDA PAD_HELD
	AND #PAD::UP
	BEQ @UNKNOWN4
	LDA #0
	STA @LOCAL00
	LDA #$007C
	STA @LOCAL00+2
	LDY #.LOWORD(-1)
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN4:
	LDA PAD_HELD
	AND #PAD::DOWN
	BEQ @UNKNOWN4_2
	LDA #0
	STA @LOCAL00
	LDA #$007C
	STA @LOCAL00+2
	LDY #1
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN4_2:
	LDA PAD_HELD
	AND #PAD::LEFT
	BEQ @UNKNOWN5
	LDA #.LOWORD(-1)
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDY #0
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN5:
	LDA PAD_HELD
	AND #PAD::RIGHT
	BEQ @UNKNOWN5_2
	LDA #1
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDY #0
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN19
@UNKNOWN5_2:
	LDA PAD_PRESS
	AND #PAD::A_BUTTON | PAD::L_BUTTON
	BEQL @UNKNOWN16
	LDA @VIRTUAL04
	CMP #8
	BNE @UNKNOWN11
	LDA @LOCAL07
	BEQ @UNKNOWN7
	CMP #19
	BEQ @UNKNOWN8
	CMP #24
	BEQ @UNKNOWN10
	JMP @UNKNOWN18
@UNKNOWN7:
	LDA #SFX::TEXT_INPUT
	JSL PLAY_SOUND
	LDY @LOCAL08
	LDX @LOCAL0A
	LDA @LOCAL0B
	JSR UNKNOWN_C1E4BE
	STA @LOCAL08
	JMP @UNKNOWN3_4
@UNKNOWN8:
	LDA #SFX::TEXT_INPUT
	JSL PLAY_SOUND
	LDY #.LOWORD(-1)
	LDX @LOCAL0C
	LDA @LOCAL0B
	JSR UNKNOWN_C1E48D
	CMP #0
	BEQL @UNKNOWN3_4
	LDA @LOCAL0A
	CMP #.LOWORD(-1)
	BEQL @UNKNOWN3_4
	LDA #1
	JMP @UNKNOWN48
@UNKNOWN10:
	LDA #SFX::UNKNOWN5E
	JSL PLAY_SOUND
	JMP @UNKNOWN21_
@UNKNOWN11:
	LDA #SFX::TEXT_INPUT
	JSL PLAY_SOUND
	LDA @VIRTUAL04
	CMP #6
	BNE @UNKNOWN15
	LDA @LOCAL07
	CMP #8
	BEQ @UNKNOWN12
	CMP #14
	BEQ @UNKNOWN13
	CMP #20
	BEQ @UNKNOWN14
	BRA @UNKNOWN18
@UNKNOWN12:
	LDX #0
	STX @LOCAL09
	JMP @UNKNOWN1
@UNKNOWN13:
	LDX #1
	STX @LOCAL09
	JMP @UNKNOWN1
@UNKNOWN14:
	LDX #2
	STX @LOCAL09
	JMP @UNKNOWN1
@UNKNOWN15:
	LDX @VIRTUAL04
	LDA @LOCAL07
	INC
	JSL UNKNOWN_C208B8
	TAY
	LDX @LOCAL0C
	LDA @LOCAL0B
	JSR UNKNOWN_C1E48D
	JMP @UNKNOWN3_4
@UNKNOWN16:
	LDA PAD_PRESS
	AND #PAD::B_BUTTON | PAD::SELECT_BUTTON
	BEQ @UNKNOWN17_
	LDA #SFX::UNKNOWN7D
	JSL PLAY_SOUND
	LDY #.LOWORD(-1)
	LDX @LOCAL0C
	LDA @LOCAL0B
	JSR UNKNOWN_C1E48D
	CMP #0
	BEQL @UNKNOWN3_4
	LDA @LOCAL0A
	CMP #.LOWORD(-1)
	BEQL @UNKNOWN3_4
	LDA #1
	JMP @UNKNOWN48
@UNKNOWN17_:
	LDA PAD_PRESS
	AND #PAD::START_BUTTON
	BEQ @UNKNOWN18
	LDA #SFX::UNKNOWN7E
	JSL PLAY_SOUND
	BRA @UNKNOWN21_
@UNKNOWN18:
	LDX @LOCAL04
	INX
	STX @LOCAL04
@UNKNOWN18_2:
	STX @VIRTUAL02
	LDA #10
	CLC
	SBC @VIRTUAL02
	JUMPGTS @UNKNOWN2_2
	JMP @UNKNOWN3_5
@UNKNOWN19:
	LDX @VIRTUAL04
	LDA @LOCAL07
	JSR UNKNOWN_C438A5
	LDA #47
	JSR UNKNOWN_C10D60
	LDY @LOCAL03
	CPY #.LOWORD(-1)
	BEQL @UNKNOWN3_4
	TYA
	AND #$00FF
	STA @LOCAL07
	TYA
	AND #$FF00
	XBA
	AND #$00FF
	STA @VIRTUAL04
	JMP @UNKNOWN3_4
@UNKNOWN21_:
	LDA @LOCAL0B
	ASL
	TAX
	LDA OPEN_WINDOW_TABLE,X
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(window_stats)
	TAX
	LDA WINDOW_STATS + window_stats::text_x,X
	BEQL @UNKNOWN3_4
	LDA @LOCAL0B
	JSR SET_WINDOW_FOCUS
	LDY #0
	STY @LOCAL09
	BRA @UNKNOWN24
@UNKNOWN23:
	LDA WINDOW_STATS + window_stats::text_y,X
	TAX
	TYA
	JSL UNKNOWN_C208B8
	SEP #PROC_FLAGS::ACCUM8
	STA (@LOCAL0D)
	REP #PROC_FLAGS::ACCUM8
	INC @LOCAL0D
	LDY @LOCAL09
	INY
	STY @LOCAL09
@UNKNOWN24:
	LDA @LOCAL0B
	ASL
	TAX
	LDA OPEN_WINDOW_TABLE,X
	OPTIMIZED_MULT @VIRTUAL04, .SIZEOF(window_stats)
	TAX
	LDY @LOCAL09
	TYA
	CMP WINDOW_STATS + window_stats::text_x,X
	BCC @UNKNOWN23
	BRA @UNKNOWN47
@UNKNOWN46:
	SEP #PROC_FLAGS::ACCUM8
	LDA #0
	STA (@LOCAL0D)
	REP #PROC_FLAGS::ACCUM8
	INC @LOCAL0D
	INY
@UNKNOWN47:
	CPY @LOCAL0C
	BCC @UNKNOWN46
	LDA #0
@UNKNOWN48:
	PLD
	RTS
