
TEXT_INPUT_DIALOG:
	BEGIN_C_FUNCTION
	STACK_RESERVE_VARS
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_PARAM_INT16
	STACK_RESERVE_RETURN_INT16
	END_STACK_VARS
	STY @LOCAL0F
	STX @LOCAL0E
	STA @LOCAL0D
	LDY @PARAM04
	STY @LOCAL0C
	LDX @PARAM03
	STX @LOCAL0B
	LDA #.LOWORD(-1)
	STA @LOCAL0A
	STZ @LOCAL09
	LDA @LOCAL09
	STA @LOCAL08
	LDA @LOCAL0B
	STA @LOCAL07
	JSL SET_INSTANT_PRINTING
	CREATE_WINDOW_NEAR #WINDOW::FILE_SELECT_NAMING_KEYBOARD
	LDA @LOCAL0C
	CMP #.LOWORD(-1)
	BNE @UNKNOWN0
	MOVE_INT f:NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS+20, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	BRA @UNKNOWN1
@UNKNOWN0:
	MOVE_INT f:NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS+16, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
@UNKNOWN1:
	SEP #PROC_FLAGS::ACCUM8
	STZ CHARACTER_PADDING
	REP #PROC_FLAGS::ACCUM8
	LDA @LOCAL0C
	CMP #.LOWORD(-1)
	BNE @UNKNOWN2
	LOADPTR NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS, @VIRTUAL0A
	LDA @LOCAL0B
	ASL
	ASL
	CLC
	ADC #8
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	DEREFERENCE_PTR_TO @VIRTUAL0A, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	BRA @UNKNOWN3
@UNKNOWN2:
	LOADPTR NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS, @VIRTUAL0A
	LDA @LOCAL0B
	ASL
	ASL
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	DEREFERENCE_PTR_TO @VIRTUAL0A, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
@UNKNOWN3:
	SEP #PROC_FLAGS::ACCUM8
	LDA #1
	STA CHARACTER_PADDING
@UNKNOWN4:
	JSL SET_INSTANT_PRINTING
	LDA @LOCAL07
	CMP @LOCAL0B
	BEQL @UNKNOWN10
	.A16
	CREATE_WINDOW_NEAR #WINDOW::FILE_SELECT_NAMING_KEYBOARD
	JSL WINDOW_TICK_WITHOUT_INSTANT_PRINTING
	.A16
	LDA @LOCAL0C
	CMP #.LOWORD(-1)
	BNE @UNKNOWN6
	MOVE_INT f:NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS+20, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	BRA @UNKNOWN7
@UNKNOWN6:
	MOVE_INT f:NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS+16, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
@UNKNOWN7:
	LDA @LOCAL0B
	STA @LOCAL07
	SEP #PROC_FLAGS::ACCUM8
	STZ CHARACTER_PADDING
	REP #PROC_FLAGS::ACCUM8
	LDA @LOCAL0C
	CMP #.LOWORD(-1)
	BNE @UNKNOWN8
	LOADPTR NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS, @VIRTUAL0A
	LDA @LOCAL0B
	OPTIMIZED_MULT @VIRTUAL04, 4
	CLC
	ADC #8
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	DEREFERENCE_PTR_TO @VIRTUAL0A, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
	BRA @UNKNOWN9
@UNKNOWN8:
	LOADPTR NAME_INPUT_WINDOW_SELECTION_LAYOUT_POINTERS, @VIRTUAL0A
	LDA @LOCAL0B
	OPTIMIZED_MULT @VIRTUAL04, 4
	CLC
	ADC @VIRTUAL0A
	STA @VIRTUAL0A
	DEREFERENCE_PTR_TO @VIRTUAL0A, @VIRTUAL06
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL DISPLAY_TEXT
@UNKNOWN9:
	SEP #PROC_FLAGS::ACCUM8
	LDA #1
	STA CHARACTER_PADDING
@UNKNOWN10:
	REP #PROC_FLAGS::ACCUM8
	LDA CURRENT_FOCUS_WINDOW
	ASL
	TAX
	LDA OPEN_WINDOW_TABLE,X
	LDY #.SIZEOF(window_stats)
	JSL MULT168
	CLC
	ADC #.LOWORD(WINDOW_STATS)
	STA @LOCAL06
@UNKNOWN11:
	JSL CLEAR_INSTANT_PRINTING
	LDX @LOCAL09
	LDA @LOCAL08
	JSL UNKNOWN_C438A5
	LDA #1
	JSR UNKNOWN_C10FEA
	LDA #33
	JSR UNKNOWN_C10D60
	LDA #0
	JSR UNKNOWN_C10FEA
	JSL WINDOW_TICK
	LDA #1
	STA @VIRTUAL04
@UNKNOWN12:
	LDA @VIRTUAL04
	EOR #$0001
	STA @VIRTUAL04
	LDY #window_stats::text_y
	LDA (@LOCAL06),Y
	ASL
	LDY #window_stats::window_y
	CLC
	ADC (@LOCAL06),Y
	OPTIMIZED_MULT @VIRTUAL04, 32
	STA @VIRTUAL02
	LDY #window_stats::window_x
	LDA (@LOCAL06),Y
	LDY #window_stats::text_x
	CLC
	ADC (@LOCAL06),Y
	CLC
	ADC @VIRTUAL02
	CLC
	ADC #VRAM::TEXT_LAYER_TILEMAP + TILEMAP_COORDS 0, 1
	STA @LOCAL05
	LDA @VIRTUAL04
	ASL
	STA @VIRTUAL02
	LOADPTR UNKNOWN_C3E406, @VIRTUAL06
	LDA @VIRTUAL02
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	STA @LOCAL00
	LDA @VIRTUAL06+2
	STA @LOCAL00+2
	LDY @LOCAL05
	LDX #2
	SEP #PROC_FLAGS::ACCUM8
	LDA #0
	JSL PREPARE_VRAM_COPY
	.A16
	LOADPTR UNKNOWN_C3E40A, @VIRTUAL06
	LDA @VIRTUAL02
	CLC
	ADC @VIRTUAL06
	STA @VIRTUAL06
	STA @LOCAL00
	LDA @VIRTUAL06+2
	STA @LOCAL00+2
	LDA @LOCAL05
	CLC
	ADC #32
	TAY
	LDX #2
	SEP #PROC_FLAGS::ACCUM8
	LDA #0
	JSL PREPARE_VRAM_COPY
	.A16
	LDX #0
	STX @LOCAL04
	JMP @UNKNOWN37
@UNKNOWN13:
	JSL UNKNOWN_C1004E
	LDA PAD_PRESS
	AND #PAD::UP
	BEQ @UNKNOWN14
	STZ @LOCAL00
	LDA #SFX::UNKNOWN7C
	STA @LOCAL00+2
	LDA @LOCAL08
	STA @LOCAL01
	LDY #window_stats::height
	LDA (@LOCAL06),Y
	LSR
	STA @LOCAL02
	LDY #.LOWORD(-1)
	LDX @LOCAL09
	LDA @LOCAL08
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN14:
	LDA PAD_PRESS
	AND #PAD::LEFT
	BEQ @UNKNOWN15
	LDA #.LOWORD(-1)
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDY #window_stats::width
	LDA (@LOCAL06),Y
	STA @LOCAL01
	LDA @LOCAL09
	STA @LOCAL02
	LDY #0
	LDX @LOCAL09
	LDA @LOCAL08
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN15:
	LDA PAD_PRESS
	AND #PAD::DOWN
	BEQ @UNKNOWN16
	STZ @LOCAL00
	LDA #SFX::UNKNOWN7C
	STA @LOCAL00+2
	LDA @LOCAL08
	STA @LOCAL01
	LDA #.LOWORD(-1)
	STA @LOCAL02
	LDY #1
	LDX @LOCAL09
	LDA @LOCAL08
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN16:
	LDA PAD_PRESS
	AND #PAD::RIGHT
	BEQ @UNKNOWN17
	LDA #1
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDA #.LOWORD(-1)
	STA @LOCAL01
	LDA @LOCAL09
	STA @LOCAL02
	LDY #0
	LDX @LOCAL09
	LDA @LOCAL08
	JSL MOVE_CURSOR
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN17:
	LDA PAD_HELD
	AND #PAD::UP
	BEQ @UNKNOWN18
	STZ @LOCAL00
	LDA #SFX::UNKNOWN7C
	STA @LOCAL00+2
	LDY #.LOWORD(-1)
	LDX @LOCAL09
	LDA @LOCAL08
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN18:
	LDA PAD_HELD
	AND #PAD::DOWN
	BEQ @UNKNOWN19
	STZ @LOCAL00
	LDA #SFX::UNKNOWN7C
	STA @LOCAL00+2
	LDY #1
	LDX @LOCAL09
	LDA @LOCAL08
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN19:
	LDA PAD_HELD
	AND #PAD::LEFT
	BEQ @UNKNOWN20
	LDA #.LOWORD(-1)
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDY #0
	LDX @LOCAL09
	LDA @LOCAL08
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN20:
	LDA PAD_HELD
	AND #PAD::RIGHT
	BEQ @UNKNOWN21
	LDA #1
	STA @LOCAL00
	LDA #$007B
	STA @LOCAL00+2
	LDY #0
	LDX @LOCAL09
	LDA @LOCAL08
	JSL UNKNOWN_C20B65
	TAY
	STY @LOCAL03
	JMP @UNKNOWN40
@UNKNOWN21:
	LDA PAD_PRESS
	AND #PAD::A_BUTTON | PAD::L_BUTTON
	BEQL @UNKNOWN32
	LDA @LOCAL09
	CMP #6
	BNE @SELECTION_NOT_IN_LINE_6
	LDA @LOCAL08
	BEQ @DONTCARE_SELECTED
	CMP #17
	BEQ @BACKSPACE_SELECTED
	CMP #25
	BEQ @OK_SELECTED
	JMP @UNKNOWN36
@DONTCARE_SELECTED:
	LDA #SFX::TEXT_INPUT
	JSL PLAY_SOUND
	LDY @LOCAL0A
	LDX @LOCAL0C
	LDA @LOCAL0D
	JSR UNKNOWN_C1E4BE
	STA @LOCAL0A
	JMP @UNKNOWN11
@BACKSPACE_SELECTED:
	LDA #SFX::TEXT_INPUT
	JSL PLAY_SOUND
	LDY #.LOWORD(-1)
	LDX @LOCAL0E
	LDA @LOCAL0D
	JSR UNKNOWN_C1E48D
	CMP #0
	BEQL @UNKNOWN11
	LDA @LOCAL0C
	CMP #.LOWORD(-1)
	BEQL @UNKNOWN11
	LDA #1
	JMP @UNKNOWN48
@OK_SELECTED:
	LDA #SFX::UNKNOWN5E
	JSL PLAY_SOUND
	JMP @UNKNOWN42
@SELECTION_NOT_IN_LINE_6:
	LDA #SFX::TEXT_INPUT
	JSL PLAY_SOUND
	LDA @LOCAL09
	CMP #4
	BNE @UNKNOWN31
	LDA @LOCAL08
	BEQ @UNKNOWN29
	CMP #7
	BEQ @UNKNOWN30
	BRA @UNKNOWN31
@UNKNOWN29:
	STZ @LOCAL0B
	JMP @UNKNOWN4
@UNKNOWN30:
	LDA #1
	STA @LOCAL0B
	JMP @UNKNOWN4
@UNKNOWN31:
	LDY @LOCAL0B
	LDX @LOCAL09
	LDA @LOCAL08
	LSR
	JSL GET_CHARACTER_AT_CURSOR_POSITION
	TAY
	LDX @LOCAL0E
	LDA @LOCAL0D
	JSR UNKNOWN_C1E48D
	JMP @UNKNOWN11
@UNKNOWN32:
	LDA PAD_PRESS
	AND #PAD::B_BUTTON | PAD::SELECT_BUTTON
	BEQ @UNKNOWN35
	LDA #SFX::UNKNOWN7D
	JSL PLAY_SOUND
	LDY #.LOWORD(-1)
	LDX @LOCAL0E
	LDA @LOCAL0D
	JSR UNKNOWN_C1E48D
	CMP #0
	BEQL @UNKNOWN11
	LDA @LOCAL0C
	CMP #.LOWORD(-1)
	BEQL @UNKNOWN11
	LDA #1
	JMP @UNKNOWN48
@UNKNOWN35:
	LDA PAD_PRESS
	AND #PAD::START_BUTTON
	BEQ @UNKNOWN36
	LDA #SFX::UNKNOWN7E
	JSL PLAY_SOUND
	BRA @UNKNOWN42
@UNKNOWN36:
	LDX @LOCAL04
	INX
	STX @LOCAL04
@UNKNOWN37:
	STX @VIRTUAL02
	LDA #10
	CLC
	SBC @VIRTUAL02
	JUMPGTS @UNKNOWN13
	JMP @UNKNOWN12
@UNKNOWN40:
	LDX @LOCAL09
	LDA @LOCAL08
	JSL UNKNOWN_C438A5
	LDA #47
	JSR UNKNOWN_C10D60
	LDY @LOCAL03
	CPY #.LOWORD(-1)
	BEQL @UNKNOWN11
	TYA
	AND #$00FF
	STA @LOCAL08
	TYA
	AND #$FF00
	XBA
	AND #$00FF
	STA @LOCAL09
	JMP @UNKNOWN11
@UNKNOWN42:
	PROMOTENEARPTR $1B86, @VIRTUAL06
	REP #PROC_FLAGS::ACCUM8
	MOVE_INT @VIRTUAL06, @LOCAL00
	JSL STRLEN
	CMP #0
	BEQL @UNKNOWN11
	LDA @LOCAL0D
	JSR SET_WINDOW_FOCUS
	LDX #0
	BRA @UNKNOWN45
@UNKNOWN44:
	SEP #PROC_FLAGS::ACCUM8
	STA (@LOCAL0F)
	REP #PROC_FLAGS::ACCUM8
	INC @LOCAL0F
	INX
@UNKNOWN45:
	LDA KEYBOARD_INPUT_CHARACTERS,X
	AND #$00FF
	BEQ @UNKNOWN47
	CPX @LOCAL0E
	BCC @UNKNOWN44
	BRA @UNKNOWN47
@UNKNOWN46:
	SEP #PROC_FLAGS::ACCUM8
	LDA #0
	STA (@LOCAL0F)
	REP #PROC_FLAGS::ACCUM8
	INC @LOCAL0F
	INX
@UNKNOWN47:
	CPX @LOCAL0E
	BCC @UNKNOWN46
	LDA #0
@UNKNOWN48:
	END_C_FUNCTION
